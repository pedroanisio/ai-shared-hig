<?xml version="1.0" ?>
<pattern xmlns="http://universal-corpus.org/schema/v1" id="P20" version="1.1">
  <metadata>
    <name>Document Store</name>
    <category>pattern</category>
    <status>stable</status>
    <complexity>medium</complexity>
  </metadata>
  <definition>
    <tuple-notation format="latex">$D = (collections, documents, queries, indices)$</tuple-notation>
    <components>
      <component>
        <name>collections</name>
        <type>Map‚ü®String, Set‚ü®Document‚ü©‚ü©</type>
        <notation>collections</notation>
        <description>group documents</description>
      </component>
      <component>
        <name>documents</name>
        <type>Set‚ü®Document‚ü©</type>
        <notation>documents</notation>
        <description>schema-free documents</description>
      </component>
      <component>
        <name>queries</name>
        <type>Query ‚Üí Set‚ü®Document‚ü©</type>
        <notation>queries</notation>
        <description>find documents</description>
      </component>
      <component>
        <name>indices</name>
        <type>Map‚ü®Path, Index‚ü©</type>
        <notation>indices</notation>
        <description>speed queries</description>
      </component>
    </components>
  </definition>
  <type-definitions>
    <type-def>
      <name>Document</name>
      <definition format="latex">Map‚ü®String, Value‚ü©  // JSON-like structure</definition>
    </type-def>
    <type-def>
      <name>Value</name>
      <definition format="latex">String | ‚Ñï | ‚Ñù | ùîπ | null | Sequence‚ü®Value‚ü© | Map‚ü®String,Value‚ü©</definition>
    </type-def>
    <type-def>
      <name>Query</name>
      <definition format="latex">(filters: Map‚ü®Path, Predicate‚ü©, projection: Set‚ü®Path‚ü©)</definition>
    </type-def>
  </type-definitions>
  <properties>
    <property id="P.P20.1">
      <name>Schema-Free</name>
      <formal-spec format="latex">Documents in same collection can have different structures</formal-spec>
    </property>
    <property id="P.P20.2">
      <name>Nested Data</name>
      <formal-spec format="latex">Documents can contain nested objects and arrays</formal-spec>
    </property>
  </properties>
  <operations>
    <operation>
      <name>Find</name>
      <signature>find({age: {$gt: 25}, city: "NYC"}) ‚Üí Set‚ü®Document‚ü©</signature>
      <formal-definition format="latex">```
   find({age: {$gt: 25}, city: "NYC"}) ‚Üí Set‚ü®Document‚ü©</formal-definition>
    </operation>
    <operation>
      <name>Insert</name>
      <signature>insert(collection, document) ‚Üí Effect</signature>
      <formal-definition format="latex">```
   insert(collection, document) ‚Üí Effect</formal-definition>
    </operation>
    <operation>
      <name>Update</name>
      <signature>update(query, changes) ‚Üí Effect</signature>
      <formal-definition format="latex">```
   update(query, changes) ‚Üí Effect</formal-definition>
    </operation>
  </operations>
  <manifestations>
    <manifestation>
      <name>Note storage</name>
      <description>Notion, Roam</description>
    </manifestation>
    <manifestation>
      <name>Configuration</name>
      <description>JSON files</description>
    </manifestation>
    <manifestation>
      <name>Log aggregation</name>
    </manifestation>
    <manifestation>
      <name>CMS content</name>
    </manifestation>
  </manifestations>
</pattern>
