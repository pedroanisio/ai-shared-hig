<?xml version="1.0" ?>
<pattern xmlns="http://universal-corpus.org/schema/v1" id="P44" version="1.1">
  <metadata>
    <name>Keyboard Shortcut System</name>
    <category>pattern</category>
    <status>stable</status>
    <complexity>medium</complexity>
  </metadata>
  <definition>
    <tuple-notation format="latex">$K = (B, M, H, C, P)$</tuple-notation>
    <components>
      <component>
        <name>B</name>
        <type>KeyCombo → Action</type>
        <notation>B</notation>
        <description>**binding map**</description>
      </component>
      <component>
        <name>H</name>
        <type>Action → String</type>
        <notation>H</notation>
        <description>**hint display function**</description>
      </component>
      <component>
        <name>C</name>
        <type>KeyCombo \times KeyCombo → \mathbb{B}</type>
        <notation>C</notation>
        <description>**conflict detector**</description>
      </component>
      <component>
        <name>P</name>
        <type>Platform → KeyMapping</type>
        <notation>P</notation>
        <description>**platform mapping**</description>
      </component>
    </components>
  </definition>
  <properties>
    <property id="P.P44.1">
      <name>Binding Uniqueness</name>
      <formal-spec format="latex">∀k₁, k₂: k₁ ≠ k₂ ⇒ B(k₁) ≠ B(k₂) ∨ scope(k₁) ∩ scope(k₂) = ∅</formal-spec>
    </property>
    <property id="P.P44.2">
      <name>Platform Mapping</name>
      <formal-spec format="latex">P(Mac): Ctrl ↦ Cmd, Alt ↦ Option
P(Windows): identity
P(Linux): identity</formal-spec>
    </property>
    <property id="P.P44.3">
      <name>Scope Hierarchy</name>
      <formal-spec format="latex">priority(component) &gt; priority(modal) &gt; priority(global)</formal-spec>
    </property>
  </properties>
  <operations>
    <operation>
      <name>Register Binding</name>
      <signature>register(combo: KeyCombo, action: Action, scope: Scope) → Effect</signature>
      <formal-definition format="latex">```
   register(combo: KeyCombo, action: Action, scope: Scope) → Effect
   = if ¬∃k: C(combo, k):
       B[combo] := (action, scope)</formal-definition>
    </operation>
    <operation>
      <name>Handle Keypress</name>
      <signature>handle(event: KeyEvent) → Effect</signature>
      <formal-definition format="latex">```
   handle(event: KeyEvent) → Effect
   = combo := extract_combo(event)
     if combo ∈ dom(B):
       preventDefault(event)
       B[combo].action()</formal-definition>
    </operation>
    <operation>
      <name>Display Hint</name>
      <signature>H(action: Action) → String</signature>
      <formal-definition format="latex">```
   H(action: Action) → String
   = format(P(current_platform), key_combo(action))</formal-definition>
    </operation>
  </operations>
  <manifestations>
    <manifestation>
      <name>Ctrl+S</name>
      <description>save</description>
    </manifestation>
    <manifestation>
      <name>Ctrl+Z/Y</name>
      <description>undo/redo</description>
    </manifestation>
    <manifestation>
      <name>Ctrl+F</name>
      <description>search</description>
    </manifestation>
    <manifestation>
      <name>Esc</name>
      <description>close dialog</description>
    </manifestation>
  </manifestations>
</pattern>
