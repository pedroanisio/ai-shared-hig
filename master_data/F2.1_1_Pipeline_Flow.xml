<?xml version='1.0' encoding='utf-8'?>
<ns0:pattern xmlns:ns0="http://universal-corpus.org/schema/v1" id="F2.1" version="1.1">
  <ns0:metadata>
    <ns0:name />
    <ns0:category>pattern</ns0:category>
    <ns0:status>stable</ns0:status>
    <ns0:complexity>medium</ns0:complexity>
  </ns0:metadata>
  <ns0:definition>
    <ns0:tuple-notation format="latex">$P = (stages, ir, error\_handler, compose)$</ns0:tuple-notation>
    <ns0:components>
      <ns0:component>
        <ns0:name>stages</ns0:name>
        <ns0:type>Sequence⟨Stage⟩</ns0:type>
        <ns0:notation>stages</ns0:notation>
        <ns0:description>transformation stages</ns0:description>
      </ns0:component>
      <ns0:component>
        <ns0:name>ir</ns0:name>
        <ns0:type>Sequence⟨IR⟩</ns0:type>
        <ns0:notation>ir</ns0:notation>
        <ns0:description>intermediate representations</ns0:description>
      </ns0:component>
      <ns0:component>
        <ns0:name>error\_handler</ns0:name>
        <ns0:type>Error → Recovery</ns0:type>
        <ns0:notation>error\_handler</ns0:notation>
        <ns0:description>handles stage failures</ns0:description>
      </ns0:component>
      <ns0:component>
        <ns0:name>compose</ns0:name>
        <ns0:type>Sequence⟨Stage⟩ → (Input → Output)</ns0:type>
        <ns0:notation>compose</ns0:notation>
        <ns0:description>composes stages</ns0:description>
      </ns0:component>
    </ns0:components>
  </ns0:definition>
  <ns0:type-definitions>
    <ns0:type-def>
      <ns0:name>Stage</ns0:name>
      <ns0:definition format="latex">(name: String, transform: Input → Output | Error)</ns0:definition>
    </ns0:type-def>
    <ns0:type-def>
      <ns0:name>IR</ns0:name>
      <ns0:definition format="latex">Intermediate representation between stages</ns0:definition>
    </ns0:type-def>
    <ns0:type-def>
      <ns0:name>Recovery</ns0:name>
      <ns0:definition format="latex">Retry | Skip | Abort | Fallback</ns0:definition>
    </ns0:type-def>
  </ns0:type-definitions>
  <ns0:properties>
    <ns0:property id="P.F2.1.1">
      <ns0:name>Sequential Composition</ns0:name>
      <ns0:formal-spec format="latex">output(stage_n) = input(stage_{n+1})
Stages connect sequentially</ns0:formal-spec>
    </ns0:property>
    <ns0:property id="P.F2.1.2">
      <ns0:name>Error Propagation</ns0:name>
      <ns0:formal-spec format="latex">error(stage_i) ⇒ handle_error ∨ abort_pipeline</ns0:formal-spec>
    </ns0:property>
    <ns0:property id="P.F2.1.3">
      <ns0:name>Determinism</ns0:name>
      <ns0:formal-spec format="latex">∀input: compose(stages)(input) produces same output</ns0:formal-spec>
    </ns0:property>
  </ns0:properties>
  <ns0:operations>
    <ns0:operation>
      <ns0:name>Execute Pipeline</ns0:name>
      <ns0:signature>execute(input: Input) → Output | Error</ns0:signature>
      <ns0:formal-definition format="latex">```
   execute(input: Input) → Output | Error
   = result := input
     for stage in stages:
       result := stage.transform(result)
       if is_error(result):
         result := error_handler(result)
         if abort(result): return result
     return result</ns0:formal-definition>
    </ns0:operation>
    <ns0:operation>
      <ns0:name>Compose Stages</ns0:name>
      <ns0:signature>compose(stages: Sequence⟨Stage⟩) → (Input → Output)</ns0:signature>
      <ns0:formal-definition format="latex">```
   compose(stages: Sequence⟨Stage⟩) → (Input → Output)
   = λ input: fold(stages, input, λ(acc, stage): stage(acc))</ns0:formal-definition>
    </ns0:operation>
    <ns0:operation>
      <ns0:name>Handle Error</ns0:name>
      <ns0:signature>handle_error(error: Error, stage: Stage) → Recovery</ns0:signature>
      <ns0:formal-definition format="latex">```
   handle_error(error: Error, stage: Stage) → Recovery
   = case error_type(error) of
       Transient → Retry(stage, max_attempts=3)
       Permanent → Abort(error)
       Recoverable → Fallback(alternative_stage)</ns0:formal-definition>
    </ns0:operation>
  </ns0:operations>
  <ns0:manifestations>
    <ns0:manifestation>
      <ns0:name>Compiler pipelines</ns0:name>
      <ns0:description>source → AST → IR → binary</ns0:description>
    </ns0:manifestation>
    <ns0:manifestation>
      <ns0:name>Data transformation</ns0:name>
      <ns0:description>ETL pipelines</ns0:description>
    </ns0:manifestation>
    <ns0:manifestation>
      <ns0:name>Build systems</ns0:name>
      <ns0:description>source → compile → link → package</ns0:description>
    </ns0:manifestation>
    <ns0:manifestation>
      <ns0:name>Markdown renderers</ns0:name>
      <ns0:description>MD → AST → HTML</ns0:description>
    </ns0:manifestation>
    <ns0:manifestation>
      <ns0:name>Image processing</ns0:name>
      <ns0:description>raw → decode → transform → encode</ns0:description>
    </ns0:manifestation>
  </ns0:manifestations>
</ns0:pattern>