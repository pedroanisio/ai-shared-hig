<?xml version="1.0" ?>
<pattern xmlns="http://universal-corpus.org/schema/v1" id="P100" version="1.1">
  <metadata>
    <name>Source Citation</name>
    <category>pattern</category>
    <status>stable</status>
    <complexity>medium</complexity>
  </metadata>
  <definition>
    <tuple-notation format="latex">$C_{source} = (Sources, Inline_{refs}, Links, Verification) : \text{Content} \to \text{Sources}_{cited}$</tuple-notation>
    <components>
      <component>
        <name>Sources</name>
        <type>Set⟨Source⟩</type>
        <notation>Sources</notation>
        <description>set of source documents with metadata</description>
      </component>
      <component>
        <name>Inline_{refs}</name>
        <type>Map⟨TextSpan, SourceId⟩</type>
        <notation>Inline_{refs}</notation>
        <description>mapping from content spans to sources</description>
      </component>
      <component>
        <name>Links</name>
        <type>Set⟨URI⟩</type>
        <notation>Links</notation>
        <description>hyperlinks to original sources</description>
      </component>
      <component>
        <name>Verification</name>
        <type>SourceId → Boolean</type>
        <notation>Verification</notation>
        <description>verifies source accessibility and validity</description>
      </component>
    </components>
  </definition>
  <type-definitions>
      <type-def>
        <name>Source</name>
        <definition>$\text{Source} = (\text{id}, \text{title}, \text{author}, \text{date}, \text{URI}, \text{confidence})$</definition>
      </type-def>
      <type-def>
        <name>TextSpan</name>
        <definition>$\text{TextSpan} = (\text{start}, \text{end}) \subset \mathbb{N} \times \mathbb{N}$ (character range)</definition>
      </type-def>
      <type-def>
        <name>Confidence</name>
        <definition>$\text{Confidence} = [0, 1] \subset \mathbb{R}$ (source reliability score)</definition>
      </type-def>
    </type-definitions>
  <properties>
    <property id="P.P100.1">
      <name>Complete Citation</name>
      <formal-spec format="latex">$\forall span \in \text{Content} : \exists s \in Sources : Inline_{refs}(span) = s.id$ (every claim cited)</formal-spec>
    </property>
    <property id="P.P100.2">
      <name>Verified Sources</name>
      <formal-spec format="latex">$\forall s \in Sources : Verification(s.id) = \text{true}$ (all sources accessible)</formal-spec>
    </property>
    <property id="P.P100.3">
      <name>Confidence Transparency</name>
      <formal-spec format="latex">$\forall s \in Sources : s.confidence \in [0,1]$ is visible to user</formal-spec>
    </property>
    <property id="P.P100.4">
      <name>Bidirectional Linking</name>
      <formal-spec format="latex">$span \xrightarrow{\text{cites}} source \land source \xrightarrow{\text{cited-by}} span$ (navigable both ways)</formal-spec>
    </property>
  </properties>
  <operations>
    <operation>
      <name>Add Citation</name>
      <signature>addCitation: TextSpan × Source → C_source</signature>
      <formal-definition format="latex">$\text{addCitation}(span, src) = C'_{source}$ where
  $Sources' = Sources \cup \{src\}$
  $Inline_{refs}' = Inline_{refs} \oplus [span \mapsto src.id]$
  $Links' = Links \cup \{src.URI\}$</formal-definition>
    </operation>
    <operation>
      <name>Verify All Sources</name>
      <signature>verifyAll: C_source → Set⟨SourceId × Boolean⟩</signature>
      <formal-definition format="latex">$\text{verifyAll}(C_{source}) = \{(s.id, accessible(s.URI)) \mid s \in Sources\}$
where $accessible: URI \to Boolean$ checks validity</formal-definition>
    </operation>
    <operation>
      <name>Get Citations for Span</name>
      <signature>getCitations: TextSpan → Set⟨Source⟩</signature>
      <formal-definition format="latex">$\text{getCitations}(span) = \{s \in Sources \mid Inline_{refs}(span) = s.id\}$</formal-definition>
    </operation>
  </operations>
  <dependencies>
    <uses>
      <pattern-ref>P9</pattern-ref>
      <pattern-ref>P101</pattern-ref>
      <pattern-ref>P102</pattern-ref>
      <pattern-ref>P103</pattern-ref>
    </uses>
  </dependencies>
  <manifestations>
    <manifestation>
      <name>Academic citations</name>
      <description>numbered references [1], [2] in papers</description>
    </manifestation>
    <manifestation>
      <name>Wikipedia footnotes</name>
      <description>superscript citation markers with source links</description>
    </manifestation>
    <manifestation>
      <name>AI-generated content citations</name>
      <description>LLM outputs with inline source attribution</description>
    </manifestation>
    <manifestation>
      <name>GraphRAG citations</name>
      <description>knowledge graph path visualization with sources</description>
    </manifestation>
  </manifestations>
</pattern>