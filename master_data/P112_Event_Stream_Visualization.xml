<?xml version="1.0" ?>
<pattern xmlns="http://universal-corpus.org/schema/v1" id="P112" version="1.1">
  <metadata>
    <name>Event Stream Visualization</name>
    <category>pattern</category>
    <status>stable</status>
    <complexity>medium</complexity>
  </metadata>
  <definition>
    <tuple-notation format="latex">$V_{stream} = (Events, Timeline, Filter, Aggregation) : \text{Event}_{stream} \to \text{Visualization}_{realtime}$</tuple-notation>
    <components>
      <component>
        <name>Events</name>
        <type>Stream⟨Event⟩</type>
        <notation>Events</notation>
        <description>real-time stream of events</description>
      </component>
      <component>
        <name>Timeline</name>
        <type>Time → Set⟨Event⟩</type>
        <notation>Timeline</notation>
        <description>temporal index of events</description>
      </component>
      <component>
        <name>Filter</name>
        <type>Event → Boolean</type>
        <notation>Filter</notation>
        <description>predicate to filter events</description>
      </component>
      <component>
        <name>Aggregation</name>
        <type>Seq⟨Event⟩ → Aggregate</type>
        <notation>Aggregation</notation>
        <description>grouping and summarization of events</description>
      </component>
    </components>
  </definition>
  <type-definitions>
      <type-def>
        <name>Event</name>
        <definition>$\text{Event} = (\text{id}, \text{type}, \text{payload}, \text{timestamp}, \text{source})$</definition>
      </type-def>
      <type-def>
        <name>Stream</name>
        <definition>$\text{Stream}\langle T \rangle = \text{Time} \to \text{Option}\langle T \rangle$ (potentially infinite)</definition>
      </type-def>
      <type-def>
        <name>Aggregate</name>
        <definition>$\text{Aggregate} = (\text{count}, \text{rate}, \text{distribution}, \text{statistics})$</definition>
      </type-def>
    </type-definitions>
  <properties>
    <property id="P.P112.1">
      <name>Real-Time Responsiveness</name>
      <formal-spec format="latex">$\forall e \in Events : \Delta t_{display}(e) = t_{render}(e) - e.timestamp &lt; 100ms$ (low latency)</formal-spec>
    </property>
    <property id="P.P112.2">
      <name>Event Ordering</name>
      <formal-spec format="latex">$\forall e_1, e_2 \in Events : e_1.timestamp &lt; e_2.timestamp \implies \text{position}(e_1) &lt; \text{position}(e_2)$</formal-spec>
    </property>
    <property id="P.P112.3">
      <name>Windowed Aggregation</name>
      <formal-spec format="latex">$\forall w \in \text{Windows} : Aggregation(w) = f(\{e \in Events \mid e.timestamp \in w\})$</formal-spec>
    </property>
    <property id="P.P112.4">
      <name>Filter Preservation</name>
      <formal-spec format="latex">$\forall e \in Events : Filter(e) = \text{true} \implies e \in \text{VisibleEvents}$</formal-spec>
    </property>
  </properties>
  <operations>
    <operation>
      <name>Subscribe to Stream</name>
      <signature>subscribe: Stream⟨Event⟩ × Filter → Stream⟨Event⟩</signature>
      <formal-definition format="latex">$\text{subscribe}(S, f) = S'$ where
  $S'(t) = \begin{cases} S(t) &amp; \text{if } f(S(t)) \\ \text{None} &amp; \text{otherwise} \end{cases}$</formal-definition>
    </operation>
    <operation>
      <name>Aggregate Window</name>
      <signature>aggregateWindow: Seq⟨Event⟩ × Window → Aggregate</signature>
      <formal-definition format="latex">$\text{aggregateWindow}(E, w) = a$ where
  $a.count = |E|$
  $a.rate = \frac{|E|}{w.duration}$
  $a.distribution = \text{groupBy}(E, \lambda e. e.type)$</formal-definition>
    </operation>
    <operation>
      <name>Render Stream</name>
      <signature>renderStream: Stream⟨Event⟩ → Visualization</signature>
      <formal-definition format="latex">$\text{renderStream}(S) = v$ where
  $v.\text{timeline} = \{(e.timestamp, e.type) \mid e \in S\}$
  $v.\text{aggregate} = Aggregation(\text{last\_n}(S, n))$</formal-definition>
    </operation>
  </operations>
  <dependencies>
    <requires>
      <pattern-ref>P22</pattern-ref>
    </requires>
    <uses>
      <pattern-ref>P111</pattern-ref>
      <pattern-ref>P114</pattern-ref>
      <pattern-ref>P115</pattern-ref>
      <pattern-ref>P117</pattern-ref>
    </uses>
  </dependencies>
  <manifestations>
    <manifestation>
      <name>Kafka real-time dashboard</name>
      <description>streaming event visualization</description>
    </manifestation>
    <manifestation>
      <name>AG-UI protocol event display</name>
      <description>16 event types rendered in real-time</description>
    </manifestation>
    <manifestation>
      <name>Datadog APM traces</name>
      <description>distributed tracing event streams</description>
    </manifestation>
    <manifestation>
      <name>Grafana time-series graphs</name>
      <description>aggregated event metrics visualization</description>
    </manifestation>
  </manifestations>
</pattern>
