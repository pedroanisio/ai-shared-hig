<?xml version="1.0" ?>
<pattern xmlns="http://universal-corpus.org/schema/v1" id="P2" version="1.1">
  <metadata>
    <name>Command Interface</name>
    <category>pattern</category>
    <status>stable</status>
    <complexity>medium</complexity>
  </metadata>
  <definition>
    <tuple-notation format="latex">$I = (input, parser, executor, history)$</tuple-notation>
    <components>
      <component>
        <name>input</name>
        <type>String</type>
        <notation>input</notation>
        <description>command text</description>
      </component>
      <component>
        <name>parser</name>
        <type>String → Command | ParseError</type>
        <notation>parser</notation>
        <description>parses input</description>
      </component>
      <component>
        <name>executor</name>
        <type>Command → Result</type>
        <notation>executor</notation>
        <description>executes commands</description>
      </component>
      <component>
        <name>history</name>
        <type>Sequence⟨String⟩</type>
        <notation>history</notation>
        <description>command history</description>
      </component>
    </components>
  </definition>
  <properties>
    <property id="P.P2.1">
      <name>Parse-Execute Cycle</name>
      <formal-spec format="latex">input → parse → validate → execute → feedback</formal-spec>
    </property>
    <property id="P.P2.2">
      <name>History Navigation</name>
      <formal-spec format="latex">↑ key → previous(history)
↓ key → next(history)</formal-spec>
    </property>
    <property id="P.P2.3">
      <name>Autocomplete</name>
      <formal-spec format="latex">partial_input → suggest(completions)
where completions ⊆ valid_commands</formal-spec>
    </property>
  </properties>
  <operations>
    <operation>
      <name>Parse Command</name>
      <signature>parse(s: String) → Command | ParseError</signature>
      <formal-definition format="latex">```
   parse(s: String) → Command | ParseError
   = tokenize(s) → match_pattern → construct_command</formal-definition>
    </operation>
    <operation>
      <name>Execute</name>
      <signature>execute(cmd: Command) → Result</signature>
      <formal-definition format="latex">```
   execute(cmd: Command) → Result
   = case cmd.type of
       Search(query) → search_engine(query)
       Create(type) → create_object(type)
       Delete(id) → delete_object(id)</formal-definition>
    </operation>
    <operation>
      <name>Suggest Completions</name>
      <signature>suggest(partial: String) → Sequence⟨String⟩</signature>
      <formal-definition format="latex">```
   suggest(partial: String) → Sequence⟨String⟩
   = filter(valid_commands, λc: startsWith(c, partial))
     → sort_by_frequency
     → take(10)</formal-definition>
    </operation>
  </operations>
  <manifestations>
    <manifestation>
      <name>Search bar</name>
      <description>Google, Spotlight</description>
    </manifestation>
    <manifestation>
      <name>Command line</name>
      <description>Terminal, bash</description>
    </manifestation>
    <manifestation>
      <name>Command palette</name>
      <description>VS Code Ctrl+Shift+P</description>
    </manifestation>
    <manifestation>
      <name>Query input</name>
      <description>SQL clients</description>
    </manifestation>
  </manifestations>
</pattern>
