<?xml version="1.0" ?>
<pattern xmlns="http://universal-corpus.org/schema/v1" id="F5" version="1.1">
  <metadata>
    <name>Collaborative Editing Flow</name>
    <category>flow</category>
    <status>stable</status>
    <complexity>medium</complexity>
  </metadata>
  <definition>
    <tuple-notation format="latex">$E = (U, D, O, T, M, \delta_{F5})$</tuple-notation>
    <components>
      <component>
        <name>T</name>
        <type>O \times O → O</type>
        <notation>T</notation>
        <description>**transformation function**</description>
      </component>
      <component>
        <name>M</name>
        <type>U → Cursor</type>
        <notation>M</notation>
        <description>tracks **user presence**</description>
      </component>
    </components>
  </definition>
  <properties/>
  <operations>
    <operation>
      <name>Local Edit</name>
      <signature>edit(user: User, op: Operation) → Effect</signature>
      <formal-definition format="latex">```
   edit(user: User, op: Operation) → Effect
   = D_user := apply(op, D_user)
     broadcast(op, user)</formal-definition>
    </operation>
    <operation>
      <name>Receive Remote Edit</name>
      <signature>receive(op: Operation, u_remote: User) → Effect</signature>
      <formal-definition format="latex">```
   receive(op: Operation, u_remote: User) → Effect
   = op' := transform(op, local_ops)
     D := apply(op', D)</formal-definition>
    </operation>
    <operation>
      <name>Transform</name>
      <signature/>
      <formal-definition format="latex">```
   T(op₁, op₂) = adjust op₁ for effects of op₂
```
Concurrent inserts at same position:
  Use user ID as tiebreaker
  
Delete vs Modify:
  Delete wins</formal-definition>
    </operation>
  </operations>
  <manifestations>
    <manifestation>
      <name>Google Docs</name>
    </manifestation>
    <manifestation>
      <name>Figma multiplayer</name>
    </manifestation>
    <manifestation>
      <name>VS Code Live Share</name>
    </manifestation>
    <manifestation>
      <name>Notion collaboration</name>
    </manifestation>
  </manifestations>
</pattern>
