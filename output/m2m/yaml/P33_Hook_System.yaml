id: P33
version: '1.1'
schema_version: '1.0'
metadata:
  name: Hook System
  category: pattern
  status: stable
  complexity: medium
  domains: []
definition:
  tuple_notation: $H = (hooks, handlers, register, invoke)$
  description: ''
  components:
  - name: hooks
    type: Set⟨HookPoint⟩
    notation: hooks
    description: extension points
  - name: handlers
    type: Map⟨HookPoint, Sequence⟨Handler⟩⟩
    notation: handlers
    description: registered handlers
  - name: register
    type: (HookPoint, Handler) → Effect
    notation: register
    description: registers handlers
  - name: invoke
    type: (HookPoint, Context) → Effect
    notation: invoke
    description: invokes handlers
type_definitions:
- name: HookPoint
  definition: String  // e.g., "before:save", "after:render"
  notation: HookPoint := String  // e.g., "before:save", "after:render"
- name: Handler
  definition: Context → Effect
  notation: Handler := Context → Effect
- name: Context
  definition: Map⟨String, Value⟩  // Hook-specific data
  notation: Context := Map⟨String, Value⟩  // Hook-specific data
properties:
- id: P.P33.1
  name: Handler Order
  formal_spec: Handlers invoked in registration order
  description: ''
  invariants: []
- id: P.P33.2
  name: Error Handling
  formal_spec: Handler error doesn't prevent other handlers from running
  description: ''
  invariants: []
operations:
- name: Register Handler
  signature: 'register(hook: HookPoint, handler: Handler, priority: ℕ) → Effect'
  formal_definition: "```\n   register(hook: HookPoint, handler: Handler, priority: ℕ) → Effect\n   =\
    \ handlers[hook] := insert_sorted(handlers[hook], (handler, priority))"
  preconditions: []
  postconditions: []
  effects: []
- name: Invoke Hooks
  signature: 'invoke(hook: HookPoint, context: Context) → Effect'
  formal_definition: "```\n   invoke(hook: HookPoint, context: Context) → Effect\n   = for (handler, priority)\
    \ in handlers[hook]:\n       try:\n         handler(context)\n       catch error:\n         log_error(error)\n\
    \         // Continue with next handler\n```\nApplication lifecycle:\n  - app:init\n  - app:ready\n\
    \  - app:shutdown\n\nData operations:\n  - before:save\n  - after:save\n  - before:delete\n  - after:delete\n\
    \nRendering:\n  - before:render\n  - after:render"
  preconditions: []
  postconditions: []
  effects: []
manifestations:
- name: Lifecycle hooks
  description: React, Vue
- name: Event handlers
  description: ''
- name: Middleware
  description: ''
- name: Aspect-oriented programming
  description: ''
