id: P20
version: '1.1'
schema_version: '1.0'
metadata:
  name: Document Store
  category: pattern
  status: stable
  complexity: medium
  domains: []
definition:
  tuple_notation: $D = (collections, documents, queries, indices)$
  description: ''
  components:
  - name: collections
    type: Map‚ü®String, Set‚ü®Document‚ü©‚ü©
    notation: collections
    description: group documents
  - name: documents
    type: Set‚ü®Document‚ü©
    notation: documents
    description: schema-free documents
  - name: queries
    type: Query ‚Üí Set‚ü®Document‚ü©
    notation: queries
    description: find documents
  - name: indices
    type: Map‚ü®Path, Index‚ü©
    notation: indices
    description: speed queries
type_definitions:
- name: Document
  definition: Map‚ü®String, Value‚ü©  // JSON-like structure
  notation: Document := Map‚ü®String, Value‚ü©  // JSON-like structure
- name: Value
  definition: String | ‚Ñï | ‚Ñù | ùîπ | null | Sequence‚ü®Value‚ü© | Map‚ü®String,Value‚ü©
  notation: Value := String | ‚Ñï | ‚Ñù | ùîπ | null | Sequence‚ü®Value‚ü© | Map‚ü®String,Value‚ü©
- name: Query
  definition: '(filters: Map‚ü®Path, Predicate‚ü©, projection: Set‚ü®Path‚ü©)'
  notation: 'Query := (filters: Map‚ü®Path, Predicate‚ü©, projection: Set‚ü®Path‚ü©)'
properties:
- id: P.P20.1
  name: Schema-Free
  formal_spec: Documents in same collection can have different structures
  description: ''
  invariants: []
- id: P.P20.2
  name: Nested Data
  formal_spec: Documents can contain nested objects and arrays
  description: ''
  invariants: []
operations:
- name: Find
  signature: 'find({age: {$gt: 25}, city: "NYC"}) ‚Üí Set‚ü®Document‚ü©'
  formal_definition: "```\n   find({age: {$gt: 25}, city: \"NYC\"}) ‚Üí Set‚ü®Document‚ü©"
  preconditions: []
  postconditions: []
  effects: []
- name: Insert
  signature: insert(collection, document) ‚Üí Effect
  formal_definition: "```\n   insert(collection, document) ‚Üí Effect"
  preconditions: []
  postconditions: []
  effects: []
- name: Update
  signature: update(query, changes) ‚Üí Effect
  formal_definition: "```\n   update(query, changes) ‚Üí Effect"
  preconditions: []
  postconditions: []
  effects: []
manifestations:
- name: Note storage
  description: Notion, Roam
- name: Configuration
  description: JSON files
- name: Log aggregation
  description: ''
- name: CMS content
  description: ''
