id: P44
version: '1.1'
schema_version: '1.0'
metadata:
  name: Keyboard Shortcut System
  category: pattern
  status: stable
  complexity: medium
  domains: []
definition:
  tuple_notation: $K = (B, M, H, C, P)$
  description: ''
  components:
  - name: B
    type: KeyCombo → Action
    notation: B
    description: '**binding map**'
  - name: H
    type: Action → String
    notation: H
    description: '**hint display function**'
  - name: C
    type: KeyCombo \times KeyCombo → \mathbb{B}
    notation: C
    description: '**conflict detector**'
  - name: P
    type: Platform → KeyMapping
    notation: P
    description: '**platform mapping**'
type_definitions: []
properties:
- id: P.P44.1
  name: Binding Uniqueness
  formal_spec: '∀k₁, k₂: k₁ ≠ k₂ ⇒ B(k₁) ≠ B(k₂) ∨ scope(k₁) ∩ scope(k₂) = ∅'
  description: ''
  invariants: []
- id: P.P44.2
  name: Platform Mapping
  formal_spec: 'P(Mac): Ctrl ↦ Cmd, Alt ↦ Option

    P(Windows): identity

    P(Linux): identity'
  description: ''
  invariants: []
- id: P.P44.3
  name: Scope Hierarchy
  formal_spec: priority(component) > priority(modal) > priority(global)
  description: ''
  invariants: []
operations:
- name: Register Binding
  signature: 'register(combo: KeyCombo, action: Action, scope: Scope) → Effect'
  formal_definition: "```\n   register(combo: KeyCombo, action: Action, scope: Scope) → Effect\n   = if\
    \ ¬∃k: C(combo, k):\n       B[combo] := (action, scope)"
  preconditions: []
  postconditions: []
  effects: []
- name: Handle Keypress
  signature: 'handle(event: KeyEvent) → Effect'
  formal_definition: "```\n   handle(event: KeyEvent) → Effect\n   = combo := extract_combo(event)\n \
    \    if combo ∈ dom(B):\n       preventDefault(event)\n       B[combo].action()"
  preconditions: []
  postconditions: []
  effects: []
- name: Display Hint
  signature: 'H(action: Action) → String'
  formal_definition: "```\n   H(action: Action) → String\n   = format(P(current_platform), key_combo(action))"
  preconditions: []
  postconditions: []
  effects: []
manifestations:
- name: Ctrl+S
  description: save
- name: Ctrl+Z/Y
  description: undo/redo
- name: Ctrl+F
  description: search
- name: Esc
  description: close dialog
