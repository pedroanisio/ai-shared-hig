id: P2
version: '1.1'
schema_version: '1.0'
metadata:
  name: Command Interface
  category: pattern
  status: stable
  complexity: medium
  domains: []
definition:
  tuple_notation: $I = (input, parser, executor, history)$
  description: ''
  components:
  - name: input
    type: String
    notation: input
    description: command text
  - name: parser
    type: String → Command | ParseError
    notation: parser
    description: parses input
  - name: executor
    type: Command → Result
    notation: executor
    description: executes commands
  - name: history
    type: Sequence⟨String⟩
    notation: history
    description: command history
type_definitions: []
properties:
- id: P.P2.1
  name: Parse-Execute Cycle
  formal_spec: input → parse → validate → execute → feedback
  description: ''
  invariants: []
- id: P.P2.2
  name: History Navigation
  formal_spec: '↑ key → previous(history)

    ↓ key → next(history)'
  description: ''
  invariants: []
- id: P.P2.3
  name: Autocomplete
  formal_spec: 'partial_input → suggest(completions)

    where completions ⊆ valid_commands'
  description: ''
  invariants: []
operations:
- name: Parse Command
  signature: 'parse(s: String) → Command | ParseError'
  formal_definition: "```\n   parse(s: String) → Command | ParseError\n   = tokenize(s) → match_pattern\
    \ → construct_command"
  preconditions: []
  postconditions: []
  effects: []
- name: Execute
  signature: 'execute(cmd: Command) → Result'
  formal_definition: "```\n   execute(cmd: Command) → Result\n   = case cmd.type of\n       Search(query)\
    \ → search_engine(query)\n       Create(type) → create_object(type)\n       Delete(id) → delete_object(id)"
  preconditions: []
  postconditions: []
  effects: []
- name: Suggest Completions
  signature: 'suggest(partial: String) → Sequence⟨String⟩'
  formal_definition: "```\n   suggest(partial: String) → Sequence⟨String⟩\n   = filter(valid_commands,\
    \ λc: startsWith(c, partial))\n     → sort_by_frequency\n     → take(10)"
  preconditions: []
  postconditions: []
  effects: []
manifestations:
- name: Search bar
  description: Google, Spotlight
- name: Command line
  description: Terminal, bash
- name: Command palette
  description: VS Code Ctrl+Shift+P
- name: Query input
  description: SQL clients
