id: P63
version: '1.1'
schema_version: '1.0'
metadata:
  name: End-to-End Test Pattern
  category: pattern
  status: stable
  complexity: medium
  domains: []
definition:
  tuple_notation: $E = (scenario, browser, pages, assertions, data)$
  description: ''
  components:
  - name: scenario
    type: UserStory
    notation: scenario
    description: user scenario being tested
  - name: browser
    type: Browser
    notation: browser
    description: automated browser
  - name: pages
    type: Map⟨String, PageObject⟩
    notation: pages
    description: represent UI pages
  - name: assertions
    type: Sequence⟨Assertion⟩
    notation: assertions
    description: verify expected outcomes
  - name: data
    type: TestData
    notation: data
    description: test data for the scenario
type_definitions:
- name: UserStory
  definition: '(actor: Actor, action: Action, outcome: Outcome)'
  notation: 'UserStory := (actor: Actor, action: Action, outcome: Outcome)'
- name: Browser
  definition: '(driver: WebDriver, capabilities: Set⟨Capability⟩)'
  notation: 'Browser := (driver: WebDriver, capabilities: Set⟨Capability⟩)'
- name: PageObject
  definition: '(locators: Map⟨String, Locator⟩, actions: Map⟨String, Action⟩)'
  notation: 'PageObject := (locators: Map⟨String, Locator⟩, actions: Map⟨String, Action⟩)'
- name: Locator
  definition: 'CSS(selector: String) | XPath(expression: String) | ID(id: String)'
  notation: 'Locator := CSS(selector: String) | XPath(expression: String) | ID(id: String)'
properties:
- id: P.P63.1
  name: Full System
  formal_spec: 'Tests complete system from user perspective

    Real browser, real UI, real backend'
  description: ''
  invariants: []
- id: P.P63.2
  name: User Scenarios
  formal_spec: 'Tests realistic user workflows

    Example: Register → Login → Purchase → Logout'
  description: ''
  invariants: []
- id: P.P63.3
  name: Slowest Tests
  formal_spec: 'Execution time: seconds to minutes

    Run less frequently than unit/integration tests'
  description: ''
  invariants: []
operations:
- name: Launch Browser
  signature: 'launch_browser(config: BrowserConfig) → Browser'
  formal_definition: "```\n   launch_browser(config: BrowserConfig) → Browser\n   = driver := create_webdriver(config.type,\
    \ config.capabilities)\n     browser := Browser(driver, config)\n     return browser"
  preconditions: []
  postconditions: []
  effects: []
- name: Execute Scenario
  signature: 'execute_scenario(scenario: UserStory, browser: Browser) → TestResult'
  formal_definition: "```\n   execute_scenario(scenario: UserStory, browser: Browser) → TestResult\n \
    \  = pages := load_page_objects(browser)\n     for step in scenario.steps:\n       execute_step(step,\
    \ pages, browser)\n     results := verify_assertions(scenario.assertions)\n     return TestResult(results)"
  preconditions: []
  postconditions: []
  effects: []
- name: Cleanup Session
  signature: 'cleanup(browser: Browser) → Effect'
  formal_definition: "```\n   cleanup(browser: Browser) → Effect\n   = browser.delete_cookies()\n    \
    \ browser.clear_local_storage()\n     browser.quit()\n```\nPage objects encapsulate UI structure:\n\
    \nclass LoginPage:\n  locators = {\n    username_input: CSS(\"#username\"),\n    password_input: CSS(\"\
    #password\"),\n    login_button: CSS(\"button[type=submit]\"),\n    error_message: CSS(\".error\"\
    )\n  }\n  \n  def login(username: String, password: String) → Effect:\n    this.find(username_input).type(username)\n\
    \    this.find(password_input).type(password)\n    this.find(login_button).click()\n  \n  def get_error()\
    \ → String:\n    return this.find(error_message).text()\n\nclass DashboardPage:\n  locators = {\n\
    \    welcome_message: CSS(\".welcome\"),\n    logout_button: CSS(\"#logout\")\n  }\n  \n  def is_displayed()\
    \ → \U0001D539:\n    return this.find(welcome_message).is_visible()\n  \n  def logout() → Effect:\n\
    \    this.find(logout_button).click()\n```\ne2e_test_user_login_flow()\n  // Setup\n  = browser :=\
    \ launch_browser(Chrome)\n    test_user := create_test_user(\"testuser\", \"password123\")\n    \n\
    \    // Navigate to login page\n    login_page := LoginPage(browser)\n    browser.navigate(\"https://app.example.com/login\"\
    )\n    \n    // Execute login\n    login_page.login(\"testuser\", \"password123\")\n    \n    // Verify\
    \ redirect to dashboard\n    dashboard := DashboardPage(browser)\n    assert(dashboard.is_displayed())\n\
    \    assert(contains(dashboard.welcome_message, \"Welcome, testuser\"))\n    \n    // Execute logout\n\
    \    dashboard.logout()\n    \n    // Verify redirect to login\n    assert(login_page.is_displayed())\n\
    \    \n    // Cleanup\n    delete_test_user(test_user)\n    browser.quit()\n```\nBrowser actions:\n\
    \  - navigate(url)\n  - refresh()\n  - back()\n  - forward()\n  - take_screenshot()\n  - execute_script(js)\n\
    \nElement actions:\n  - find(locator) → Element\n  - click()\n  - type(text)\n  - clear()\n  - submit()\n\
    \  - select(option)\n  - hover()\n  - drag_and_drop(source, target)\n\nWaits:\n  - wait_for_element(locator,\
    \ timeout)\n  - wait_for_visibility(element, timeout)\n  - wait_for_text(element, text, timeout)\n\
    \  - wait_for_url(url, timeout)\n\nAssertions:\n  - assert_visible(element)\n  - assert_text(element,\
    \ expected)\n  - assert_url(expected)\n  - assert_title(expected)\n  - assert_element_count(locator,\
    \ count)\n```\n1. Use Page Objects:\n   Encapsulate page structure\n   Reusable across tests\n   Easier\
    \ maintenance\n\n2. Explicit Waits:\n   Wait for specific conditions\n   Don't use sleep()\n   Handle\
    \ async behavior\n\n3. Independent Tests:\n   Each test starts from clean state\n   No dependencies\
    \ between tests\n   Can run in any order\n\n4. Minimize Test Data:\n   Use minimum data needed\n \
    \  Clean up after test\n   Avoid shared test data\n\n5. Stable Locators:\n   Use IDs or data attributes\n\
    \   Avoid brittle CSS selectors\n   Don't rely on text content\nTest Environments:**\n```\nHeadless\
    \ mode:\n  browser := Chrome(headless=true)\n  Faster, no GUI\n  Good for CI/CD\n\nGrid/Cloud:\n \
    \ Run tests on multiple browsers in parallel\n  Selenium Grid, BrowserStack, Sauce Labs\n\nDocker:\n\
    \  Consistent environment\n  Isolated tests\n  Easy CI/CD integration"
  preconditions: []
  postconditions: []
  effects: []
manifestations:
- name: UI automation
  description: Selenium, Playwright, Cypress
- name: Acceptance tests
  description: ''
- name: Smoke tests
  description: ''
- name: Regression tests
  description: ''
