id: P59
version: '1.1'
schema_version: '1.0'
metadata:
  name: Authorization Pattern
  category: pattern
  status: stable
  complexity: medium
  domains: []
definition:
  tuple_notation: $Z = (subjects, objects, permissions, policies, check)$
  description: ''
  components:
  - name: subjects
    type: Set‚ü®Subject‚ü©
    notation: subjects
    description: actors (users, services)
  - name: objects
    type: Set‚ü®Object‚ü©
    notation: objects
    description: resources
  - name: permissions
    type: Set‚ü®Permission‚ü©
    notation: permissions
    description: allowed actions
  - name: policies
    type: Subject \times Object \times Action ‚Üí \mathbb{B}
    notation: policies
    description: define rules
  - name: check
    type: (Subject, Object, Action) ‚Üí \mathbb{B}
    notation: check
    description: evaluates access
type_definitions:
- name: Subject
  definition: User | Service | Group
  notation: Subject := User | Service | Group
- name: Object
  definition: 'Resource(id: ID, type: Type, owner: Subject)'
  notation: 'Object := Resource(id: ID, type: Type, owner: Subject)'
- name: Permission
  definition: '(subject: Subject, object: Object, actions: Set‚ü®Action‚ü©)'
  notation: 'Permission := (subject: Subject, object: Object, actions: Set‚ü®Action‚ü©)'
- name: Action
  definition: Read | Write | Execute | Delete | Share | Admin
  notation: Action := Read | Write | Execute | Delete | Share | Admin
- name: Policy
  definition: '(condition: Predicate, effect: Allow | Deny)'
  notation: 'Policy := (condition: Predicate, effect: Allow | Deny)'
properties:
- id: P.P59.1
  name: Least Privilege
  formal_spec: 'Default deny: access denied unless explicitly allowed'
  description: ''
  invariants: []
- id: P.P59.2
  name: Policy Evaluation
  formal_spec: 'Explicit deny overrides allow

    Multiple policies combined with AND'
  description: ''
  invariants: []
- id: P.P59.3
  name: Inheritance
  formal_spec: 'Group permissions inherited by members

    Parent resource permissions inherited by children'
  description: ''
  invariants: []
operations:
- name: Check Permission
  signature: 'check(subject: Subject, object: Object, action: Action) ‚Üí ùîπ'
  formal_definition: "```\n   check(subject: Subject, object: Object, action: Action) ‚Üí \U0001D539\n \
    \  = policies_applicable := filter(policies, Œªp: p.applies(subject, object, action))\n     \n    \
    \ // Check for explicit deny\n     if ‚àÉp ‚àà policies_applicable: p.effect = Deny:\n       return false\n\
    \     \n     // Check for explicit allow\n     if ‚àÉp ‚àà policies_applicable: p.effect = Allow:\n  \
    \     return true\n     \n     // Default deny\n     return false"
  preconditions: []
  postconditions: []
  effects: []
- name: Grant Permission
  signature: 'grant(subject: Subject, object: Object, actions: Set‚ü®Action‚ü©) ‚Üí Effect'
  formal_definition: "```\n   grant(subject: Subject, object: Object, actions: Set‚ü®Action‚ü©) ‚Üí Effect\n\
    \   = permission := Permission(subject, object, actions)\n     permissions := permissions ‚à™ {permission}"
  preconditions: []
  postconditions: []
  effects: []
- name: Revoke Permission
  signature: 'revoke(subject: Subject, object: Object) ‚Üí Effect'
  formal_definition: "```\n   revoke(subject: Subject, object: Object) ‚Üí Effect\n   = permissions := permissions\
    \ ‚àñ {p : p.subject = subject ‚àß p.object = object}"
  preconditions: []
  postconditions: []
  effects: []
- name: Evaluate Policy
  signature: 'evaluate_policy(policy: Policy, context: Context) ‚Üí Allow | Deny'
  formal_definition: "```\n   evaluate_policy(policy: Policy, context: Context) ‚Üí Allow | Deny\n   = if\
    \ policy.condition(context):\n       return policy.effect\n     else:\n       return NotApplicable"
  preconditions: []
  postconditions: []
  effects: []
- name: Role-Based Access Control (RBAC)
  signature: ''
  formal_definition: "```\n   Users assigned to roles\n   Roles have permissions\n   user ‚Üí roles ‚Üí permissions\
    \ ‚Üí resources\n   \n   Example:\n     Admin role: can do everything\n     Editor role: can read, write\n\
    \     Viewer role: can read only"
  preconditions: []
  postconditions: []
  effects: []
- name: Attribute-Based Access Control (ABAC)
  signature: ''
  formal_definition: "```\n   Policies based on attributes of subject, object, environment\n   \n   Example:\n\
    \     Allow if user.department = resource.department\n     Allow if time_of_day between 9am and 5pm"
  preconditions: []
  postconditions: []
  effects: []
- name: Access Control Lists (ACL)
  signature: ''
  formal_definition: "```\n   Each resource has list of allowed subjects and actions\n   \n   Example:\n\
    \     document123.acl = [\n       (alice, Read|Write),\n       (bob, Read),\n       (admin_group,\
    \ *)\n     ]"
  preconditions: []
  postconditions: []
  effects: []
- name: Ownership
  signature: ''
  formal_definition: "```\n   Resource owner has full control\n   Owner can grant permissions to others\n\
    ```\nPolicy 1: Owner full access\n  condition: subject = object.owner\n  effect: Allow all actions\n\
    \nPolicy 2: Department access\n  condition: subject.department = object.department\n  effect: Allow\
    \ Read\n\nPolicy 3: Admin access\n  condition: subject.role = Admin\n  effect: Allow all actions\n\
    \nPolicy 4: Deny deleted users\n  condition: subject.status = Deleted\n  effect: Deny all actions"
  preconditions: []
  postconditions: []
  effects: []
manifestations:
- name: File permission systems
  description: ''
- name: API authorization
  description: ''
- name: Database row-level security
  description: ''
- name: Cloud resource access
  description: AWS IAM
