<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CMS Editor - Architecture & Flow Visualization</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        :root {
            --primary-500: #0EA5E9;
            --primary-600: #0284C7;
            --primary-700: #0369A1;
            --gray-50: #F9FAFB;
            --gray-100: #F3F4F6;
            --gray-200: #E5E7EB;
            --gray-300: #D1D5DB;
            --gray-600: #4B5563;
            --gray-700: #374151;
            --gray-800: #1F2937;
            --gray-900: #111827;
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--gray-50);
            color: var(--gray-900);
        }
        .header {
            background: white;
            border-bottom: 2px solid var(--gray-200);
            padding: 1.5rem 2rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .header h1 {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--primary-700);
        }
        .header p {
            color: var(--gray-600);
            font-size: 0.95rem;
            margin-top: 0.5rem;
        }
        .controls {
            background: white;
            border-bottom: 1px solid var(--gray-200);
            padding: 1rem 2rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }
        .btn {
            padding: 0.5rem 1rem;
            border: 2px solid var(--gray-300);
            background: white;
            border-radius: 0.5rem;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s;
            color: var(--gray-700);
        }
        .btn:hover {
            background: var(--gray-50);
            border-color: var(--primary-500);
        }
        .btn.active {
            background: var(--primary-500);
            color: white;
            border-color: var(--primary-600);
        }
        .main-container {
            display: flex;
            height: calc(100vh - 180px);
        }
        .visualization-panel {
            flex: 1;
            padding: 2rem;
            overflow: auto;
        }
        .diagram-container {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            overflow: hidden;
            margin: 0 auto;
            max-width: 1600px;
        }
        .screenshot {
            width: 100%;
            height: auto;
            display: block;
        }
        .info-panel {
            width: 400px;
            background: white;
            border-left: 1px solid var(--gray-200);
            overflow-y: auto;
            padding: 2rem;
        }
        .info-header h3 {
            font-size: 1.25rem;
            color: var(--gray-900);
            margin-bottom: 1rem;
        }
        .pattern-card {
            background: var(--gray-50);
            border: 1px solid var(--gray-200);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 1rem;
        }
        .pattern-id {
            display: inline-block;
            background: var(--primary-500);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        .pattern-name {
            font-size: 1rem;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 0.5rem;
        }
        .pattern-desc {
            font-size: 0.875rem;
            color: var(--gray-600);
            line-height: 1.6;
        }
        .layer-box {
            cursor: pointer;
            transition: all 0.3s;
        }
        .layer-box:hover {
            filter: brightness(1.1);
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üèóÔ∏è CMS Editor - Technical Architecture Visualization</h1>
        <p>Interactive diagrams showing system architecture, data flows, and pattern implementations from Technical Architecture v2.0</p>
    </div>

    <div class="controls">
        <div style="display: flex; align-items: center; gap: 1rem; flex-wrap: wrap;">
            <label>Architecture View:</label>
            <button class="btn active" data-view="system">System Architecture</button>
            <button class="btn" data-view="pipeline">Processing Pipeline (P10)</button>
            <button class="btn" data-view="validation">Validation System (P11)</button>
            <button class="btn" data-view="collaboration">Collaboration (F5/OT)</button>
            <button class="btn" data-view="state">State Management</button>
            <button class="btn" data-view="deployment">Deployment</button>
        </div>
    </div>

    <div class="main-container">
        <div class="visualization-panel">
            <div class="diagram-container" id="diagramContainer"></div>
        </div>

        <div class="info-panel" id="infoPanel">
            <div class="info-header">
                <h3 id="infoTitle">System Architecture</h3>
            </div>
            <div id="infoContent"></div>
        </div>
    </div>

    <script>
        const VIEWS = {
            system: {
                name: 'System Architecture',
                description: 'High-level layered architecture showing presentation, application, API, backend services, and data layers.',
                patterns: ['P10', 'P11', 'P13', 'P30', 'C1', 'C2'],
                svg: `
                    <svg viewBox="0 0 1600 1200" xmlns="http://www.w3.org/2000/svg" class="screenshot">
                        <defs>
                            <linearGradient id="grad1" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#0EA5E9;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#0284C7;stop-opacity:1" />
                            </linearGradient>
                            <linearGradient id="grad2" x1="0%" y1="0%" x2="0%" y2="100%">
                                <stop offset="0%" style="stop-color:#10B981;stop-opacity:1" />
                                <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
                            </linearGradient>
                        </defs>
                        
                        <rect width="1600" height="1200" fill="#F9FAFB"/>
                        
                        <!-- Layer Labels -->
                        <text x="50" y="80" font-family="system-ui" font-size="28" font-weight="700" fill="#111827">Layered Architecture</text>
                        
                        <!-- Presentation Layer -->
                        <rect x="100" y="120" width="1400" height="180" rx="12" fill="url(#grad1)" opacity="0.2" stroke="#0EA5E9" stroke-width="3"/>
                        <text x="130" y="160" font-family="system-ui" font-size="20" font-weight="700" fill="#0369A1">PRESENTATION LAYER</text>
                        
                        <rect x="140" y="180" width="380" height="100" rx="8" fill="white" stroke="#0EA5E9" stroke-width="2"/>
                        <text x="170" y="215" font-family="system-ui" font-size="16" font-weight="600" fill="#111827">React UI Components</text>
                        <text x="170" y="240" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Editor, Media, Dashboard</text>
                        <text x="170" y="260" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Responsive layouts</text>
                        
                        <rect x="560" y="180" width="380" height="100" rx="8" fill="white" stroke="#0EA5E9" stroke-width="2"/>
                        <text x="590" y="215" font-family="system-ui" font-size="16" font-weight="600" fill="#111827">WebSocket Client</text>
                        <text x="590" y="240" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Real-time updates (F5)</text>
                        <text x="590" y="260" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Collaboration sync</text>
                        
                        <rect x="980" y="180" width="380" height="100" rx="8" fill="white" stroke="#0EA5E9" stroke-width="2"/>
                        <text x="1010" y="215" font-family="system-ui" font-size="16" font-weight="600" fill="#111827">Service Workers</text>
                        <text x="1010" y="240" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Offline support</text>
                        <text x="1010" y="260" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Cache management</text>
                        
                        <!-- Application Layer -->
                        <rect x="100" y="350" width="1400" height="260" rx="12" fill="url(#grad2)" opacity="0.2" stroke="#10B981" stroke-width="3"/>
                        <text x="130" y="390" font-family="system-ui" font-size="20" font-weight="700" fill="#065F46">APPLICATION LAYER</text>
                        
                        <rect x="140" y="410" width="280" height="80" rx="8" fill="white" stroke="#10B981" stroke-width="2"/>
                        <text x="160" y="440" font-family="system-ui" font-size="15" font-weight="600" fill="#111827">Zustand</text>
                        <text x="160" y="465" font-family="system-ui" font-size="12" fill="#6B7280">State Management</text>
                        
                        <rect x="460" y="410" width="280" height="80" rx="8" fill="white" stroke="#10B981" stroke-width="2"/>
                        <text x="480" y="440" font-family="system-ui" font-size="15" font-weight="600" fill="#111827">React Query</text>
                        <text x="480" y="465" font-family="system-ui" font-size="12" fill="#6B7280">Server State</text>
                        
                        <rect x="780" y="410" width="280" height="80" rx="8" fill="white" stroke="#10B981" stroke-width="2"/>
                        <text x="800" y="440" font-family="system-ui" font-size="15" font-weight="600" fill="#111827">IndexedDB</text>
                        <text x="800" y="465" font-family="system-ui" font-size="12" fill="#6B7280">Local Cache</text>
                        
                        <rect x="1100" y="410" width="260" height="80" rx="8" fill="white" stroke="#10B981" stroke-width="2"/>
                        <text x="1120" y="440" font-family="system-ui" font-size="15" font-weight="600" fill="#111827">Command History</text>
                        <text x="1120" y="465" font-family="system-ui" font-size="12" fill="#6B7280">Undo/Redo (P30)</text>
                        
                        <!-- Business Logic -->
                        <rect x="140" y="510" width="1220" height="80" rx="8" fill="white" stroke="#10B981" stroke-width="2"/>
                        <text x="160" y="540" font-family="system-ui" font-size="15" font-weight="600" fill="#111827">Business Logic Layer</text>
                        
                        <rect x="180" y="555" width="180" height="25" rx="4" fill="#E0F2FE"/>
                        <text x="195" y="573" font-family="system-ui" font-size="12" font-weight="600" fill="#0369A1">Parser (P10)</text>
                        
                        <rect x="380" y="555" width="200" height="25" rx="4" fill="#E0F2FE"/>
                        <text x="395" y="573" font-family="system-ui" font-size="12" font-weight="600" fill="#0369A1">Validator (P11)</text>
                        
                        <rect x="600" y="555" width="180" height="25" rx="4" fill="#E0F2FE"/>
                        <text x="615" y="573" font-family="system-ui" font-size="12" font-weight="600" fill="#0369A1">Indexer (P13)</text>
                        
                        <rect x="800" y="555" width="200" height="25" rx="4" fill="#E0F2FE"/>
                        <text x="815" y="573" font-family="system-ui" font-size="12" font-weight="600" fill="#0369A1">Command (P30)</text>
                        
                        <rect x="1020" y="555" width="160" height="25" rx="4" fill="#E0F2FE"/>
                        <text x="1035" y="573" font-family="system-ui" font-size="12" font-weight="600" fill="#0369A1">Graph (C1)</text>
                        
                        <rect x="1200" y="555" width="140" height="25" rx="4" fill="#E0F2FE"/>
                        <text x="1215" y="573" font-family="system-ui" font-size="12" font-weight="600" fill="#0369A1">Doc (C2)</text>
                        
                        <!-- API Gateway Layer -->
                        <rect x="100" y="660" width="1400" height="120" rx="12" fill="#FEF3C7" opacity="0.3" stroke="#F59E0B" stroke-width="3"/>
                        <text x="130" y="700" font-family="system-ui" font-size="20" font-weight="700" fill="#92400E">API GATEWAY</text>
                        
                        <rect x="200" y="720" width="180" height="40" rx="6" fill="white" stroke="#F59E0B" stroke-width="2"/>
                        <text x="220" y="746" font-family="system-ui" font-size="13" fill="#111827">Auth Middleware</text>
                        
                        <rect x="420" y="720" width="180" height="40" rx="6" fill="white" stroke="#F59E0B" stroke-width="2"/>
                        <text x="440" y="746" font-family="system-ui" font-size="13" fill="#111827">Rate Limiting</text>
                        
                        <rect x="640" y="720" width="180" height="40" rx="6" fill="white" stroke="#F59E0B" stroke-width="2"/>
                        <text x="660" y="746" font-family="system-ui" font-size="13" fill="#111827">Routing</text>
                        
                        <rect x="860" y="720" width="220" height="40" rx="6" fill="white" stroke="#F59E0B" stroke-width="2"/>
                        <text x="880" y="746" font-family="system-ui" font-size="13" fill="#111827">Load Balancer</text>
                        
                        <!-- Backend Services -->
                        <rect x="100" y="830" width="1400" height="180" rx="12" fill="#FEE2E2" opacity="0.3" stroke="#EF4444" stroke-width="3"/>
                        <text x="130" y="870" font-family="system-ui" font-size="20" font-weight="700" fill="#991B1B">BACKEND SERVICES</text>
                        
                        <rect x="180" y="890" width="250" height="80" rx="8" fill="white" stroke="#EF4444" stroke-width="2"/>
                        <text x="200" y="920" font-family="system-ui" font-size="15" font-weight="600" fill="#111827">Content Service</text>
                        <text x="200" y="945" font-family="system-ui" font-size="12" fill="#6B7280">Node.js/Express</text>
                        
                        <rect x="470" y="890" width="250" height="80" rx="8" fill="white" stroke="#EF4444" stroke-width="2"/>
                        <text x="490" y="920" font-family="system-ui" font-size="15" font-weight="600" fill="#111827">Media Service</text>
                        <text x="490" y="945" font-family="system-ui" font-size="12" fill="#6B7280">Upload/Transform</text>
                        
                        <rect x="760" y="890" width="250" height="80" rx="8" fill="white" stroke="#EF4444" stroke-width="2"/>
                        <text x="780" y="920" font-family="system-ui" font-size="15" font-weight="600" fill="#111827">User Service</text>
                        <text x="780" y="945" font-family="system-ui" font-size="12" fill="#6B7280">Auth/Permissions</text>
                        
                        <rect x="1050" y="890" width="300" height="80" rx="8" fill="white" stroke="#EF4444" stroke-width="2"/>
                        <text x="1070" y="920" font-family="system-ui" font-size="15" font-weight="600" fill="#111827">Collaboration Service</text>
                        <text x="1070" y="945" font-family="system-ui" font-size="12" fill="#6B7280">WebSocket/OT (F5)</text>
                        
                        <!-- Data Layer -->
                        <rect x="100" y="1050" width="1400" height="120" rx="12" fill="#DDD6FE" opacity="0.3" stroke="#8B5CF6" stroke-width="3"/>
                        <text x="130" y="1090" font-family="system-ui" font-size="20" font-weight="700" fill="#5B21B6">DATA LAYER</text>
                        
                        <rect x="150" y="1110" width="200" height="40" rx="6" fill="white" stroke="#8B5CF6" stroke-width="2"/>
                        <text x="170" y="1136" font-family="system-ui" font-size="13" fill="#111827">PostgreSQL</text>
                        
                        <rect x="380" y="1110" width="200" height="40" rx="6" fill="white" stroke="#8B5CF6" stroke-width="2"/>
                        <text x="400" y="1136" font-family="system-ui" font-size="13" fill="#111827">Meilisearch (P13)</text>
                        
                        <rect x="610" y="1110" width="200" height="40" rx="6" fill="white" stroke="#8B5CF6" stroke-width="2"/>
                        <text x="630" y="1136" font-family="system-ui" font-size="13" fill="#111827">Redis Cache (P17)</text>
                        
                        <rect x="840" y="1110" width="200" height="40" rx="6" fill="white" stroke="#8B5CF6" stroke-width="2"/>
                        <text x="860" y="1136" font-family="system-ui" font-size="13" fill="#111827">S3 / Object Storage</text>
                        
                        <rect x="1070" y="1110" width="200" height="40" rx="6" fill="white" stroke="#8B5CF6" stroke-width="2"/>
                        <text x="1090" y="1136" font-family="system-ui" font-size="13" fill="#111827">Neo4j (C1)</text>
                        
                        <!-- Arrows -->
                        <path d="M 800 300 L 800 350" stroke="#6B7280" stroke-width="3" marker-end="url(#arrowhead)" fill="none"/>
                        <path d="M 800 610 L 800 660" stroke="#6B7280" stroke-width="3" marker-end="url(#arrowhead)" fill="none"/>
                        <path d="M 800 780 L 800 830" stroke="#6B7280" stroke-width="3" marker-end="url(#arrowhead)" fill="none"/>
                        <path d="M 800 1010 L 800 1050" stroke="#6B7280" stroke-width="3" marker-end="url(#arrowhead)" fill="none"/>
                        
                        <defs>
                            <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="5" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#6B7280" />
                            </marker>
                        </defs>
                    </svg>
                `
            },
            
            pipeline: {
                name: 'Processing Pipeline (P10)',
                description: 'Content transformation pipeline: Lexer ‚Üí Parser ‚Üí Validator ‚Üí Transformer ‚Üí Renderer',
                patterns: ['P10', 'P11', 'C3'],
                svg: `
                    <svg viewBox="0 0 1200 1400" xmlns="http://www.w3.org/2000/svg" class="screenshot">
                        <rect width="1200" height="1400" fill="#F9FAFB"/>
                        
                        <text x="50" y="60" font-family="system-ui" font-size="32" font-weight="700" fill="#0EA5E9">Content Processing Pipeline (P10)</text>
                        <text x="50" y="100" font-family="system-ui" font-size="16" fill="#6B7280">5-stage transformation from raw input to rendered output</text>
                        
                        <!-- Input -->
                        <rect x="350" y="150" width="500" height="80" rx="12" fill="#E0F2FE" stroke="#0EA5E9" stroke-width="3"/>
                        <text x="480" y="190" font-family="system-ui" font-size="18" font-weight="600" fill="#0369A1">Raw Input (Markdown/HTML)</text>
                        <text x="380" y="215" font-family="monospace" font-size="13" fill="#6B7280"># Title\nText with [link](url)</text>
                        
                        <!-- Arrow -->
                        <path d="M 600 230 L 600 280" stroke="#6B7280" stroke-width="4" marker-end="url(#arrow)" fill="none"/>
                        
                        <!-- Stage 1: Lexer -->
                        <rect x="250" y="280" width="700" height="140" rx="12" fill="white" stroke="#10B981" stroke-width="3"/>
                        <text x="280" y="320" font-family="system-ui" font-size="22" font-weight="700" fill="#10B981">1. LEXER</text>
                        <text x="280" y="350" font-family="system-ui" font-size="14" fill="#6B7280">Tokenization - Breaking input into tokens</text>
                        
                        <rect x="280" y="370" width="880" height="35" rx="6" fill="#F0FDF4"/>
                        <text x="300" y="393" font-family="monospace" font-size="12" fill="#065F46">"# Title" ‚Üí [HEADING(1, "Title")]</text>
                        
                        <path d="M 600 420 L 600 480" stroke="#6B7280" stroke-width="4" marker-end="url(#arrow)" fill="none"/>
                        
                        <!-- Stage 2: Parser -->
                        <rect x="250" y="480" width="700" height="180" rx="12" fill="white" stroke="#10B981" stroke-width="3"/>
                        <text x="280" y="520" font-family="system-ui" font-size="22" font-weight="700" fill="#10B981">2. PARSER</text>
                        <text x="280" y="550" font-family="system-ui" font-size="14" fill="#6B7280">AST Construction - Building syntax tree (C3)</text>
                        
                        <text x="300" y="585" font-family="monospace" font-size="12" fill="#065F46">Root</text>
                        <text x="320" y="610" font-family="monospace" font-size="12" fill="#065F46">‚îú‚îÄ Heading(1, "Title")</text>
                        <text x="320" y="630" font-family="monospace" font-size="12" fill="#065F46">‚îî‚îÄ Paragraph</text>
                        <text x="340" y="650" font-family="monospace" font-size="12" fill="#065F46">‚îî‚îÄ Link(text, url)</text>
                        
                        <path d="M 600 660 L 600 720" stroke="#6B7280" stroke-width="4" marker-end="url(#arrow)" fill="none"/>
                        
                        <!-- Stage 3: Validator -->
                        <rect x="250" y="720" width="700" height="160" rx="12" fill="white" stroke="#F59E0B" stroke-width="3"/>
                        <text x="280" y="760" font-family="system-ui" font-size="22" font-weight="700" fill="#F59E0B">3. VALIDATOR (P11)</text>
                        <text x="280" y="790" font-family="system-ui" font-size="14" fill="#6B7280">Multi-level validation checks</text>
                        
                        <text x="300" y="820" font-family="system-ui" font-size="13" fill="#10B981">‚úì Syntax: Structure valid</text>
                        <text x="300" y="845" font-family="system-ui" font-size="13" fill="#F59E0B">‚ö† Semantic: Link may be broken</text>
                        <text x="300" y="870" font-family="system-ui" font-size="13" fill="#10B981">‚úì Business: Required fields present</text>
                        
                        <path d="M 600 880 L 600 940" stroke="#6B7280" stroke-width="4" marker-end="url(#arrow)" fill="none"/>
                        
                        <!-- Stage 4: Transformer -->
                        <rect x="250" y="940" width="700" height="160" rx="12" fill="white" stroke="#8B5CF6" stroke-width="3"/>
                        <text x="280" y="980" font-family="system-ui" font-size="22" font-weight="700" fill="#8B5CF6">4. TRANSFORMER</text>
                        <text x="280" y="1010" font-family="system-ui" font-size="14" fill="#6B7280">Plugins & optimizations</text>
                        
                        <text x="300" y="1040" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Convert markdown ‚Üí HTML</text>
                        <text x="300" y="1065" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Syntax highlighting for code</text>
                        <text x="300" y="1090" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Optimize/resize images</text>
                        
                        <path d="M 600 1100 L 600 1160" stroke="#6B7280" stroke-width="4" marker-end="url(#arrow)" fill="none"/>
                        
                        <!-- Stage 5: Renderer -->
                        <rect x="250" y="1160" width="700" height="120" rx="12" fill="white" stroke="#EF4444" stroke-width="3"/>
                        <text x="280" y="1200" font-family="system-ui" font-size="22" font-weight="700" fill="#EF4444">5. RENDERER</text>
                        <text x="280" y="1230" font-family="system-ui" font-size="14" fill="#6B7280">Output generation (HTML/JSON/Markdown)</text>
                        
                        <rect x="280" y="1245" width="640" height="25" rx="4" fill="#FEE2E2"/>
                        <text x="300" y="1263" font-family="monospace" font-size="11" fill="#991B1B">&lt;article&gt;&lt;h1&gt;Title&lt;/h1&gt;&lt;p&gt;Text...&lt;/p&gt;&lt;/article&gt;</text>
                        
                        <!-- Output -->
                        <path d="M 600 1280 L 600 1310" stroke="#6B7280" stroke-width="4" marker-end="url(#arrow)" fill="none"/>
                        
                        <rect x="350" y="1310" width="500" height="60" rx="12" fill="#D1FAE5" stroke="#10B981" stroke-width="3"/>
                        <text x="440" y="1350" font-family="system-ui" font-size="18" font-weight="600" fill="#065F46">Final Output (HTML/JSON/Static)</text>
                        
                        <defs>
                            <marker id="arrow" markerWidth="10" markerHeight="10" refX="5" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#6B7280" />
                            </marker>
                        </defs>
                    </svg>
                `
            },
            
            validation: {
                name: 'Validation System (P11)',
                description: 'Multi-level validation pipeline with automatic fixes and suggestions',
                patterns: ['P11', 'P16'],
                svg: `
                    <svg viewBox="0 0 1400 1000" xmlns="http://www.w3.org/2000/svg" class="screenshot">
                        <rect width="1400" height="1000" fill="#F9FAFB"/>
                        
                        <text x="50" y="60" font-family="system-ui" font-size="32" font-weight="700" fill="#F59E0B">Validation Pipeline (P11)</text>
                        <text x="50" y="100" font-family="system-ui" font-size="16" fill="#6B7280">Parallel validation with severity levels and auto-fix suggestions</text>
                        
                        <!-- Input -->
                        <rect x="550" y="140" width="300" height="60" rx="10" fill="#E0F2FE" stroke="#0EA5E9" stroke-width="3"/>
                        <text x="620" y="178" font-family="system-ui" font-size="18" font-weight="600" fill="#0369A1">Content Input</text>
                        
                        <!-- Split arrows -->
                        <path d="M 700 200 L 700 250 L 300 250 L 300 300" stroke="#6B7280" stroke-width="3" fill="none"/>
                        <path d="M 700 250 L 500 250 L 500 300" stroke="#6B7280" stroke-width="3" fill="none"/>
                        <path d="M 700 250 L 900 250 L 900 300" stroke="#6B7280" stroke-width="3" fill="none"/>
                        <path d="M 900 250 L 1100 250 L 1100 300" stroke="#6B7280" stroke-width="3" fill="none"/>
                        
                        <!-- Validators -->
                        <rect x="150" y="300" width="300" height="180" rx="10" fill="white" stroke="#10B981" stroke-width="3"/>
                        <text x="180" y="340" font-family="system-ui" font-size="20" font-weight="700" fill="#10B981">Syntax Validator</text>
                        <text x="180" y="375" font-family="system-ui" font-size="13" fill="#6B7280">‚úì Markdown structure</text>
                        <text x="180" y="400" font-family="system-ui" font-size="13" fill="#6B7280">‚úì HTML well-formed</text>
                        <text x="180" y="425" font-family="system-ui" font-size="13" fill="#6B7280">‚úì JSON valid</text>
                        <text x="180" y="450" font-family="system-ui" font-size="13" fill="#6B7280">‚úì No syntax errors</text>
                        
                        <rect x="500" y="300" width="300" height="180" rx="10" fill="white" stroke="#F59E0B" stroke-width="3"/>
                        <text x="530" y="340" font-family="system-ui" font-size="20" font-weight="700" fill="#F59E0B">Semantic Validator</text>
                        <text x="530" y="375" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Check internal links</text>
                        <text x="530" y="400" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Verify image refs</text>
                        <text x="530" y="425" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Validate IDs unique</text>
                        <text x="530" y="450" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Check dependencies</text>
                        
                        <rect x="850" y="300" width="300" height="180" rx="10" fill="white" stroke="#8B5CF6" stroke-width="3"/>
                        <text x="880" y="340" font-family="system-ui" font-size="20" font-weight="700" fill="#8B5CF6">Business Validator</text>
                        <text x="880" y="375" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Required fields</text>
                        <text x="880" y="400" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Workflow state</text>
                        <text x="880" y="425" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ User permissions</text>
                        <text x="880" y="450" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Business rules</text>
                        
                        <rect x="1200" y="300" width="150" height="180" rx="10" fill="white" stroke="#0EA5E9" stroke-width="3"/>
                        <text x="1220" y="340" font-family="system-ui" font-size="18" font-weight="700" fill="#0EA5E9">A11y</text>
                        <text x="1220" y="340" font-family="system-ui" font-size="18" font-weight="700" fill="#0EA5E9">Validator</text>
                        <text x="1220" y="380" font-family="system-ui" font-size="11" fill="#6B7280">‚Ä¢ Alt text</text>
                        <text x="1220" y="405" font-family="system-ui" font-size="11" fill="#6B7280">‚Ä¢ Headings</text>
                        <text x="1220" y="430" font-family="system-ui" font-size="11" fill="#6B7280">‚Ä¢ Contrast</text>
                        <text x="1220" y="455" font-family="system-ui" font-size="11" fill="#6B7280">‚Ä¢ ARIA</text>
                        
                        <!-- Merge arrows -->
                        <path d="M 300 480 L 300 530 L 700 530 L 700 580" stroke="#6B7280" stroke-width="3" fill="none"/>
                        <path d="M 650 480 L 650 530" stroke="#6B7280" stroke-width="3" fill="none"/>
                        <path d="M 1000 480 L 1000 530 L 700 530" stroke="#6B7280" stroke-width="3" fill="none"/>
                        <path d="M 1275 480 L 1275 530 L 700 530" stroke="#6B7280" stroke-width="3" fill="none"/>
                        
                        <!-- Results -->
                        <rect x="200" y="580" width="1000" height="300" rx="10" fill="white" stroke="#6B7280" stroke-width="3"/>
                        <text x="230" y="620" font-family="system-ui" font-size="22" font-weight="700" fill="#111827">Validation Results</text>
                        
                        <!-- Errors -->
                        <rect x="230" y="645" width="940" height="60" rx="6" fill="#FEE2E2"/>
                        <text x="250" y="667" font-family="system-ui" font-size="14" font-weight="600" fill="#991B1B">Errors (Blocking):</text>
                        <text x="250" y="690" font-family="system-ui" font-size="13" fill="#991B1B">üî¥ Broken internal link: /missing-page</text>
                        
                        <!-- Warnings -->
                        <rect x="230" y="720" width="940" height="75" rx="6" fill="#FEF3C7"/>
                        <text x="250" y="742" font-family="system-ui" font-size="14" font-weight="600" fill="#92400E">Warnings (Non-blocking):</text>
                        <text x="250" y="765" font-family="system-ui" font-size="13" fill="#92400E">üü° Image missing alt text</text>
                        <text x="250" y="785" font-family="system-ui" font-size="13" fill="#92400E">üü° Heading hierarchy skipped (h2 ‚Üí h4)</text>
                        
                        <!-- Suggestions -->
                        <rect x="230" y="810" width="940" height="55" rx="6" fill="#DBEAFE"/>
                        <text x="250" y="832" font-family="system-ui" font-size="14" font-weight="600" fill="#1E40AF">Suggestions (P16 - AI):</text>
                        <text x="250" y="852" font-family="system-ui" font-size="13" fill="#1E40AF">üîµ Consider adding related links ‚Ä¢ SEO: Meta description recommended</text>
                        
                        <!-- Auto-fix -->
                        <rect x="300" y="910" width="800" height="60" rx="8" fill="#D1FAE5" stroke="#10B981" stroke-width="2"/>
                        <text x="320" y="935" font-family="system-ui" font-size="16" font-weight="600" fill="#065F46">Automatic Fixes Available</text>
                        <text x="320" y="958" font-family="system-ui" font-size="13" fill="#065F46">‚úì Fix heading hierarchy ‚Ä¢ Generate alt text (AI) ‚Ä¢ Format code blocks</text>
                    </svg>
                `
            },
            
            collaboration: {
                name: 'Collaborative Editing (F5)',
                description: 'Operational Transform system for real-time multi-user editing with conflict resolution',
                patterns: ['F5', 'P23', 'P31'],
                svg: `
                    <svg viewBox="0 0 1600 1100" xmlns="http://www.w3.org/2000/svg" class="screenshot">
                        <rect width="1600" height="1100" fill="#F9FAFB"/>
                        
                        <text x="50" y="60" font-family="system-ui" font-size="32" font-weight="700" fill="#8B5CF6">Operational Transform System (F5)</text>
                        <text x="50" y="100" font-family="system-ui" font-size="16" fill="#6B7280">Real-time collaborative editing with automatic conflict resolution (P23)</text>
                        
                        <!-- User A -->
                        <rect x="100" y="150" width="400" height="800" rx="12" fill="white" stroke="#0EA5E9" stroke-width="3"/>
                        <text x="130" y="200" font-family="system-ui" font-size="24" font-weight="700" fill="#0EA5E9">User A's Client</text>
                        
                        <rect x="130" y="230" width="340" height="100" rx="8" fill="#F0F9FF"/>
                        <text x="150" y="260" font-family="system-ui" font-size="14" font-weight="600" fill="#0369A1">Local Edit</text>
                        <text x="150" y="285" font-family="monospace" font-size="13" fill="#6B7280">Insert "Hello" at pos 0</text>
                        <text x="150" y="310" font-family="system-ui" font-size="12" fill="#9CA3AF">Timestamp: T1</text>
                        
                        <path d="M 300 330 L 300 380" stroke="#0EA5E9" stroke-width="3" marker-end="url(#arrowBlue)" fill="none"/>
                        
                        <rect x="130" y="380" width="340" height="80" rx="8" fill="#DBEAFE"/>
                        <text x="150" y="410" font-family="system-ui" font-size="14" font-weight="600" fill="#0369A1">Send to Server</text>
                        <text x="150" y="435" font-family="monospace" font-size="12" fill="#6B7280">op: insert("Hello", 0)</text>
                        
                        <path d="M 470 420 L 650 420" stroke="#0EA5E9" stroke-width="3" marker-end="url(#arrowBlue)" fill="none"/>
                        
                        <rect x="130" y="600" width="340" height="100" rx="8" fill="#FEF3C7"/>
                        <text x="150" y="630" font-family="system-ui" font-size="14" font-weight="600" fill="#92400E">Receive from B</text>
                        <text x="150" y="655" font-family="monospace" font-size="13" fill="#6B7280">Insert "World" at pos 0</text>
                        <text x="150" y="680" font-family="system-ui" font-size="12" fill="#9CA3AF">Timestamp: T2</text>
                        
                        <path d="M 300 700 L 300 750" stroke="#F59E0B" stroke-width="3" marker-end="url(#arrowOrange)" fill="none"/>
                        
                        <rect x="130" y="750" width="340" height="100" rx="8" fill="#D1FAE5"/>
                        <text x="150" y="780" font-family="system-ui" font-size="14" font-weight="600" fill="#065F46">Transform & Apply</text>
                        <text x="150" y="805" font-family="monospace" font-size="12" fill="#6B7280">Transform(B_op, A_op)</text>
                        <text x="150" y="830" font-family="system-ui" font-size="12" fill="#065F46">Result: "World Hello"</text>
                        
                        <!-- Server -->
                        <rect x="650" y="150" width="300" height="800" rx="12" fill="white" stroke="#10B981" stroke-width="3"/>
                        <text x="680" y="200" font-family="system-ui" font-size="24" font-weight="700" fill="#10B981">Server</text>
                        
                        <rect x="680" y="230" width="240" height="120" rx="8" fill="#F0FDF4"/>
                        <text x="700" y="260" font-family="system-ui" font-size="14" font-weight="600" fill="#065F46">OT Engine</text>
                        <text x="700" y="285" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ Receive operations</text>
                        <text x="700" y="305" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ Detect conflicts</text>
                        <text x="700" y="325" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ Transform ops</text>
                        
                        <rect x="680" y="380" width="240" height="140" rx="8" fill="#D1FAE5"/>
                        <text x="700" y="410" font-family="system-ui" font-size="14" font-weight="600" fill="#065F46">Operation Queue</text>
                        <text x="700" y="435" font-family="monospace" font-size="11" fill="#6B7280">1. A: insert("Hello")</text>
                        <text x="700" y="455" font-family="monospace" font-size="11" fill="#6B7280">2. B: insert("World")</text>
                        <text x="700" y="490" font-family="system-ui" font-size="12" font-weight="600" fill="#065F46">Conflict detected!</text>
                        <text x="700" y="510" font-family="system-ui" font-size="11" fill="#6B7280">Same position edits</text>
                        
                        <rect x="680" y="550" width="240" height="100" rx="8" fill="#FEF3C7"/>
                        <text x="700" y="580" font-family="system-ui" font-size="14" font-weight="600" fill="#92400E">Broadcast</text>
                        <text x="700" y="605" font-family="system-ui" font-size="12" fill="#6B7280">Send to User A</text>
                        <text x="700" y="625" font-family="system-ui" font-size="12" fill="#6B7280">Send to User B</text>
                        
                        <path d="M 680 590 L 500 640" stroke="#F59E0B" stroke-width="3" marker-end="url(#arrowOrange)" fill="none"/>
                        <path d="M 920 590 L 1100 640" stroke="#F59E0B" stroke-width="3" marker-end="url(#arrowOrange)" fill="none"/>
                        
                        <rect x="680" y="680" width="240" height="100" rx="8" fill="#E0E7FF"/>
                        <text x="700" y="710" font-family="system-ui" font-size="14" font-weight="600" fill="#3730A3">Final State</text>
                        <text x="700" y="735" font-family="monospace" font-size="13" fill="#3730A3">"World Hello"</text>
                        <text x="700" y="760" font-family="system-ui" font-size="11" fill="#6B7280">‚úì Convergence</text>
                        
                        <!-- User B -->
                        <rect x="1100" y="150" width="400" height="800" rx="12" fill="white" stroke="#F59E0B" stroke-width="3"/>
                        <text x="1130" y="200" font-family="system-ui" font-size="24" font-weight="700" fill="#F59E0B">User B's Client</text>
                        
                        <rect x="1130" y="230" width="340" height="100" rx="8" fill="#FEF3C7"/>
                        <text x="1150" y="260" font-family="system-ui" font-size="14" font-weight="600" fill="#92400E">Local Edit</text>
                        <text x="1150" y="285" font-family="monospace" font-size="13" fill="#6B7280">Insert "World" at pos 0</text>
                        <text x="1150" y="310" font-family="system-ui" font-size="12" fill="#9CA3AF">Timestamp: T2</text>
                        
                        <path d="M 1300 330 L 1300 380" stroke="#F59E0B" stroke-width="3" marker-end="url(#arrowOrange)" fill="none"/>
                        
                        <rect x="1130" y="380" width="340" height="80" rx="8" fill="#FDE68A"/>
                        <text x="1150" y="410" font-family="system-ui" font-size="14" font-weight="600" fill="#92400E">Send to Server</text>
                        <text x="1150" y="435" font-family="monospace" font-size="12" fill="#6B7280">op: insert("World", 0)</text>
                        
                        <path d="M 1130 420 L 950 420" stroke="#F59E0B" stroke-width="3" marker-end="url(#arrowOrange)" fill="none"/>
                        
                        <rect x="1130" y="600" width="340" height="100" rx="8" fill="#E0F2FE"/>
                        <text x="1150" y="630" font-family="system-ui" font-size="14" font-weight="600" fill="#0369A1">Receive from A</text>
                        <text x="1150" y="655" font-family="monospace" font-size="13" fill="#6B7280">Insert "Hello" at pos 0</text>
                        <text x="1150" y="680" font-family="system-ui" font-size="12" fill="#9CA3AF">Timestamp: T1</text>
                        
                        <path d="M 1300 700 L 1300 750" stroke="#0EA5E9" stroke-width="3" marker-end="url(#arrowBlue)" fill="none"/>
                        
                        <rect x="1130" y="750" width="340" height="100" rx="8" fill="#D1FAE5"/>
                        <text x="1150" y="780" font-family="system-ui" font-size="14" font-weight="600" fill="#065F46">Transform & Apply</text>
                        <text x="1150" y="805" font-family="monospace" font-size="12" fill="#6B7280">Transform(A_op, B_op)</text>
                        <text x="1150" y="830" font-family="system-ui" font-size="12" fill="#065F46">Result: "World Hello"</text>
                        
                        <!-- Properties box -->
                        <rect x="400" y="980" width="800" height="90" rx="10" fill="#F0F9FF" stroke="#0EA5E9" stroke-width="2"/>
                        <text x="420" y="1010" font-family="system-ui" font-size="16" font-weight="700" fill="#0369A1">OT Properties Guaranteed:</text>
                        <text x="420" y="1035" font-family="system-ui" font-size="13" fill="#6B7280">‚úì <tspan font-weight="600">Convergence:</tspan> All clients reach same final state</text>
                        <text x="420" y="1055" font-family="system-ui" font-size="13" fill="#6B7280">‚úì <tspan font-weight="600">Causality:</tspan> Operations maintain causal relationships ‚Ä¢ <tspan font-weight="600">Intention:</tspan> User intentions preserved</text>
                        
                        <defs>
                            <marker id="arrowBlue" markerWidth="10" markerHeight="10" refX="5" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#0EA5E9" />
                            </marker>
                            <marker id="arrowOrange" markerWidth="10" markerHeight="10" refX="5" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#F59E0B" />
                            </marker>
                        </defs>
                    </svg>
                `
            },
            
            state: {
                name: 'State Management',
                description: 'Multi-layered state architecture: UI ‚Üí Feature ‚Üí Server ‚Üí Persistent',
                patterns: ['P29', 'P30', 'P31'],
                svg: `
                    <svg viewBox="0 0 1400 1100" xmlns="http://www.w3.org/2000/svg" class="screenshot">
                        <rect width="1400" height="1100" fill="#F9FAFB"/>
                        
                        <text x="50" y="60" font-family="system-ui" font-size="32" font-weight="700" fill="#8B5CF6">State Management Architecture</text>
                        <text x="50" y="100" font-family="system-ui" font-size="16" fill="#6B7280">4-layer state architecture with MVC pattern (P29) and Observable updates (P31)</text>
                        
                        <!-- Layer 1: UI Component State -->
                        <rect x="100" y="140" width="1200" height="160" rx="12" fill="white" stroke="#0EA5E9" stroke-width="3"/>
                        <text x="130" y="180" font-family="system-ui" font-size="22" font-weight="700" fill="#0EA5E9">Layer 1: UI Component State (React)</text>
                        
                        <rect x="150" y="200" width="280" height="70" rx="6" fill="#F0F9FF"/>
                        <text x="170" y="230" font-family="system-ui" font-size="14" font-weight="600" fill="#0369A1">Form Inputs</text>
                        <text x="170" y="255" font-family="system-ui" font-size="12" fill="#6B7280">useState, useReducer</text>
                        
                        <rect x="460" y="200" width="280" height="70" rx="6" fill="#F0F9FF"/>
                        <text x="480" y="230" font-family="system-ui" font-size="14" font-weight="600" fill="#0369A1">Modal Visibility</text>
                        <text x="480" y="255" font-family="system-ui" font-size="12" fill="#6B7280">Local toggles</text>
                        
                        <rect x="770" y="200" width="280" height="70" rx="6" fill="#F0F9FF"/>
                        <text x="790" y="230" font-family="system-ui" font-size="14" font-weight="600" fill="#0369A1">UI Interactions</text>
                        <text x="790" y="255" font-family="system-ui" font-size="12" fill="#6B7280">Hover, focus states</text>
                        
                        <!-- Arrow -->
                        <path d="M 700 300 L 700 350" stroke="#6B7280" stroke-width="4" marker-end="url(#arrow)" fill="none"/>
                        
                        <!-- Layer 2: Feature State -->
                        <rect x="100" y="350" width="1200" height="220" rx="12" fill="white" stroke="#10B981" stroke-width="3"/>
                        <text x="130" y="390" font-family="system-ui" font-size="22" font-weight="700" fill="#10B981">Layer 2: Feature State (Zustand)</text>
                        
                        <rect x="150" y="410" width="330" height="130" rx="6" fill="#F0FDF4"/>
                        <text x="170" y="440" font-family="system-ui" font-size="14" font-weight="600" fill="#065F46">Editor Store (P30)</text>
                        <text x="170" y="465" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ content: Block[]</text>
                        <text x="170" y="485" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ selection: Selection</text>
                        <text x="170" y="505" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ history: UndoStack</text>
                        <text x="170" y="525" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ executeCommand()</text>
                        
                        <rect x="510" y="410" width="330" height="130" rx="6" fill="#F0FDF4"/>
                        <text x="530" y="440" font-family="system-ui" font-size="14" font-weight="600" fill="#065F46">Media Store</text>
                        <text x="530" y="465" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ items: Media[]</text>
                        <text x="530" y="485" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ selected: Set</text>
                        <text x="530" y="505" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ uploading: Progress</text>
                        
                        <rect x="870" y="410" width="330" height="130" rx="6" fill="#F0FDF4"/>
                        <text x="890" y="440" font-family="system-ui" font-size="14" font-weight="600" fill="#065F46">Search Store</text>
                        <text x="890" y="465" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ query: string</text>
                        <text x="890" y="485" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ filters: Filter[]</text>
                        <text x="890" y="505" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ results: Result[]</text>
                        
                        <!-- Arrow -->
                        <path d="M 700 570 L 700 620" stroke="#6B7280" stroke-width="4" marker-end="url(#arrow)" fill="none"/>
                        
                        <!-- Layer 3: Server State -->
                        <rect x="100" y="620" width="1200" height="200" rx="12" fill="white" stroke="#F59E0B" stroke-width="3"/>
                        <text x="130" y="660" font-family="system-ui" font-size="22" font-weight="700" fill="#F59E0B">Layer 3: Server State (React Query)</text>
                        
                        <rect x="150" y="680" width="330" height="110" rx="6" fill="#FEF3C7"/>
                        <text x="170" y="710" font-family="system-ui" font-size="14" font-weight="600" fill="#92400E">Content Cache</text>
                        <text x="170" y="735" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ Fetched data</text>
                        <text x="170" y="755" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ Cached with TTL</text>
                        <text x="170" y="775" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ Auto refetch</text>
                        
                        <rect x="510" y="680" width="330" height="110" rx="6" fill="#FEF3C7"/>
                        <text x="530" y="710" font-family="system-ui" font-size="14" font-weight="600" fill="#92400E">Users Cache</text>
                        <text x="530" y="735" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ User profiles</text>
                        <text x="530" y="755" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ Stale time: 5min</text>
                        <text x="530" y="775" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ Optimistic updates</text>
                        
                        <rect x="870" y="680" width="330" height="110" rx="6" fill="#FEF3C7"/>
                        <text x="890" y="710" font-family="system-ui" font-size="14" font-weight="600" fill="#92400E">Settings Cache</text>
                        <text x="890" y="735" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ System config</text>
                        <text x="890" y="755" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ Long TTL</text>
                        <text x="890" y="775" font-family="system-ui" font-size="12" fill="#6B7280">‚Ä¢ Background sync</text>
                        
                        <!-- Arrow -->
                        <path d="M 700 820 L 700 870" stroke="#6B7280" stroke-width="4" marker-end="url(#arrow)" fill="none"/>
                        
                        <!-- Layer 4: Persistent State -->
                        <rect x="100" y="870" width="1200" height="180" rx="12" fill="white" stroke="#8B5CF6" stroke-width="3"/>
                        <text x="130" y="910" font-family="system-ui" font-size="22" font-weight="700" fill="#8B5CF6">Layer 4: Persistent State (IndexedDB)</text>
                        
                        <rect x="150" y="930" width="250" height="90" rx="6" fill="#F5F3FF"/>
                        <text x="170" y="960" font-family="system-ui" font-size="14" font-weight="600" fill="#5B21B6">Offline Drafts</text>
                        <text x="170" y="985" font-family="system-ui" font-size="12" fill="#6B7280">Unsynced content</text>
                        
                        <rect x="430" y="930" width="250" height="90" rx="6" fill="#F5F3FF"/>
                        <text x="450" y="960" font-family="system-ui" font-size="14" font-weight="600" fill="#5B21B6">Pending Changes</text>
                        <text x="450" y="985" font-family="system-ui" font-size="12" fill="#6B7280">Sync queue</text>
                        
                        <rect x="710" y="930" width="250" height="90" rx="6" fill="#F5F3FF"/>
                        <text x="730" y="960" font-family="system-ui" font-size="14" font-weight="600" fill="#5B21B6">Preferences</text>
                        <text x="730" y="985" font-family="system-ui" font-size="12" fill="#6B7280">User settings</text>
                        
                        <rect x="990" y="930" width="250" height="90" rx="6" fill="#F5F3FF"/>
                        <text x="1010" y="960" font-family="system-ui" font-size="14" font-weight="600" fill="#5B21B6">Media Cache</text>
                        <text x="1010" y="985" font-family="system-ui" font-size="12" fill="#6B7280">Thumbnails</text>
                        
                        <!-- Data flow annotation -->
                        <rect x="400" y="1070" width="600" height="20" rx="4" fill="#E0F2FE"/>
                        <text x="420" y="1085" font-family="system-ui" font-size="13" font-weight="600" fill="#0369A1">Data Flow: UI ‚Üî Feature ‚Üî Server ‚Üî API ‚Üî Database</text>
                        
                        <defs>
                            <marker id="arrow" markerWidth="10" markerHeight="10" refX="5" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#6B7280" />
                            </marker>
                        </defs>
                    </svg>
                `
            },
            
            deployment: {
                name: 'Deployment Architecture',
                description: 'Production deployment with CDN, load balancing, horizontal scaling, and monitoring',
                patterns: ['P17', 'P18', 'P19'],
                svg: `
                    <svg viewBox="0 0 1400 1200" xmlns="http://www.w3.org/2000/svg" class="screenshot">
                        <rect width="1400" height="1200" fill="#F9FAFB"/>
                        
                        <text x="50" y="60" font-family="system-ui" font-size="32" font-weight="700" fill="#EF4444">Production Deployment Architecture</text>
                        <text x="50" y="100" font-family="system-ui" font-size="16" fill="#6B7280">Scalable infrastructure with CDN, load balancing, and redundancy</text>
                        
                        <!-- CDN Layer -->
                        <rect x="300" y="140" width="800" height="100" rx="12" fill="white" stroke="#0EA5E9" stroke-width="3"/>
                        <text x="550" y="180" font-family="system-ui" font-size="20" font-weight="700" fill="#0EA5E9">CDN (Cloudflare)</text>
                        <text x="330" y="210" font-family="system-ui" font-size="13" fill="#6B7280">‚Ä¢ Static assets caching ‚Ä¢ DDoS protection ‚Ä¢ SSL/TLS termination ‚Ä¢ Global edge network</text>
                        
                        <path d="M 700 240 L 700 290" stroke="#6B7280" stroke-width="4" marker-end="url(#arrow)" fill="none"/>
                        
                        <!-- Load Balancer -->
                        <rect x="400" y="290" width="600" height="80" rx="12" fill="white" stroke="#10B981" stroke-width="3"/>
                        <text x="550" y="330" font-family="system-ui" font-size="20" font-weight="700" fill="#10B981">Load Balancer (Nginx)</text>
                        <text x="430" y="355" font-family="system-ui" font-size="13" fill="#6B7280">Round-robin distribution ‚Ä¢ Health checks ‚Ä¢ SSL termination</text>
                        
                        <path d="M 600 370 L 400 430" stroke="#6B7280" stroke-width="3" marker-end="url(#arrow)" fill="none"/>
                        <path d="M 700 370 L 700 430" stroke="#6B7280" stroke-width="3" marker-end="url(#arrow)" fill="none"/>
                        <path d="M 800 370 L 1000 430" stroke="#6B7280" stroke-width="3" marker-end="url(#arrow)" fill="none"/>
                        
                        <!-- App Servers -->
                        <rect x="200" y="430" width="250" height="120" rx="10" fill="white" stroke="#8B5CF6" stroke-width="2"/>
                        <text x="250" y="470" font-family="system-ui" font-size="16" font-weight="600" fill="#8B5CF6">App Server 1</text>
                        <text x="220" y="495" font-family="system-ui" font-size="12" fill="#6B7280">Node.js Express</text>
                        <text x="220" y="515" font-family="system-ui" font-size="12" fill="#6B7280">Docker Container</text>
                        <text x="220" y="535" font-family="system-ui" font-size="12" fill="#10B981">‚úì Healthy</text>
                        
                        <rect x="475" y="430" width="250" height="120" rx="10" fill="white" stroke="#8B5CF6" stroke-width="2"/>
                        <text x="525" y="470" font-family="system-ui" font-size="16" font-weight="600" fill="#8B5CF6">App Server 2</text>
                        <text x="495" y="495" font-family="system-ui" font-size="12" fill="#6B7280">Node.js Express</text>
                        <text x="495" y="515" font-family="system-ui" font-size="12" fill="#6B7280">Docker Container</text>
                        <text x="495" y="535" font-family="system-ui" font-size="12" fill="#10B981">‚úì Healthy</text>
                        
                        <rect x="750" y="430" width="250" height="120" rx="10" fill="white" stroke="#8B5CF6" stroke-width="2"/>
                        <text x="800" y="470" font-family="system-ui" font-size="16" font-weight="600" fill="#8B5CF6">App Server 3</text>
                        <text x="770" y="495" font-family="system-ui" font-size="12" fill="#6B7280">Node.js Express</text>
                        <text x="770" y="515" font-family="system-ui" font-size="12" fill="#6B7280">Docker Container</text>
                        <text x="770" y="535" font-family="system-ui" font-size="12" fill="#10B981">‚úì Healthy</text>
                        
                        <!-- Connection arrows to databases -->
                        <path d="M 325 550 L 300 640" stroke="#6B7280" stroke-width="2" fill="none"/>
                        <path d="M 600 550 L 530 640" stroke="#6B7280" stroke-width="2" fill="none"/>
                        <path d="M 875 550 L 750 640" stroke="#6B7280" stroke-width="2" fill="none"/>
                        
                        <path d="M 325 550 L 950 640" stroke="#6B7280" stroke-width="2" fill="none"/>
                        <path d="M 600 550 L 1130 640" stroke="#6B7280" stroke-width="2" fill="none"/>
                        
                        <!-- Databases -->
                        <rect x="150" y="640" width="220" height="100" rx="8" fill="white" stroke="#F59E0B" stroke-width="2"/>
                        <text x="190" y="675" font-family="system-ui" font-size="15" font-weight="600" fill="#F59E0B">PostgreSQL</text>
                        <text x="170" y="700" font-family="system-ui" font-size="12" fill="#6B7280">Primary (P18)</text>
                        <text x="170" y="720" font-family="system-ui" font-size="12" fill="#6B7280">Content storage</text>
                        
                        <rect x="400" y="640" width="220" height="100" rx="8" fill="white" stroke="#F59E0B" stroke-width="2"/>
                        <text x="440" y="675" font-family="system-ui" font-size="15" font-weight="600" fill="#F59E0B">Meilisearch</text>
                        <text x="420" y="700" font-family="system-ui" font-size="12" fill="#6B7280">Search Index (P13)</text>
                        <text x="420" y="720" font-family="system-ui" font-size="12" fill="#6B7280">Full-text search</text>
                        
                        <rect x="650" y="640" width="220" height="100" rx="8" fill="white" stroke="#F59E0B" stroke-width="2"/>
                        <text x="705" y="675" font-family="system-ui" font-size="15" font-weight="600" fill="#F59E0B">Redis</text>
                        <text x="670" y="700" font-family="system-ui" font-size="12" fill="#6B7280">Cache (P17)</text>
                        <text x="670" y="720" font-family="system-ui" font-size="12" fill="#6B7280">Sessions & cache</text>
                        
                        <rect x="900" y="640" width="220" height="100" rx="8" fill="white" stroke="#F59E0B" stroke-width="2"/>
                        <text x="960" y="675" font-family="system-ui" font-size="15" font-weight="600" fill="#F59E0B">S3 / CDN</text>
                        <text x="920" y="700" font-family="system-ui" font-size="12" fill="#6B7280">Object Storage</text>
                        <text x="920" y="720" font-family="system-ui" font-size="12" fill="#6B7280">Media files</text>
                        
                        <rect x="1150" y="640" width="200" height="100" rx="8" fill="white" stroke="#F59E0B" stroke-width="2"/>
                        <text x="1200" y="675" font-family="system-ui" font-size="15" font-weight="600" fill="#F59E0B">Neo4j</text>
                        <text x="1170" y="700" font-family="system-ui" font-size="12" fill="#6B7280">Graph DB (C1)</text>
                        <text x="1170" y="720" font-family="system-ui" font-size="12" fill="#6B7280">Relationships</text>
                        
                        <!-- Replication -->
                        <path d="M 260 740 L 260 820" stroke="#6B7280" stroke-width="2" stroke-dasharray="4,4" fill="none"/>
                        
                        <rect x="150" y="820" width="220" height="80" rx="8" fill="white" stroke="#9CA3AF" stroke-width="2" stroke-dasharray="4,4"/>
                        <text x="185" y="855" font-family="system-ui" font-size="14" font-weight="600" fill="#6B7280">PostgreSQL</text>
                        <text x="170" y="880" font-family="system-ui" font-size="11" fill="#9CA3AF">Replica (Read-only)</text>
                        
                        <!-- Monitoring Section -->
                        <rect x="100" y="950" width="1200" height="200" rx="12" fill="white" stroke="#EF4444" stroke-width="3"/>
                        <text x="130" y="990" font-family="system-ui" font-size="20" font-weight="700" fill="#EF4444">Monitoring & Logging</text>
                        
                        <rect x="150" y="1010" width="300" height="110" rx="8" fill="#FEE2E2"/>
                        <text x="170" y="1045" font-family="system-ui" font-size="15" font-weight="600" fill="#991B1B">Prometheus</text>
                        <text x="170" y="1070" font-family="system-ui" font-size="12" fill="#6B7280">Metrics collection</text>
                        <text x="170" y="1090" font-family="system-ui" font-size="12" fill="#6B7280">Time-series DB</text>
                        <text x="170" y="1110" font-family="system-ui" font-size="12" fill="#6B7280">Alerting rules</text>
                        
                        <rect x="480" y="1010" width="300" height="110" rx="8" fill="#DBEAFE"/>
                        <text x="500" y="1045" font-family="system-ui" font-size="15" font-weight="600" fill="#1E40AF">Grafana</text>
                        <text x="500" y="1070" font-family="system-ui" font-size="12" fill="#6B7280">Dashboards</text>
                        <text x="500" y="1090" font-family="system-ui" font-size="12" fill="#6B7280">Visualizations</text>
                        <text x="500" y="1110" font-family="system-ui" font-size="12" fill="#6B7280">Real-time metrics</text>
                        
                        <rect x="810" y="1010" width="300" height="110" rx="8" fill="#FEF3C7"/>
                        <text x="830" y="1045" font-family="system-ui" font-size="15" font-weight="600" fill="#92400E">Sentry</text>
                        <text x="830" y="1070" font-family="system-ui" font-size="12" fill="#6B7280">Error tracking</text>
                        <text x="830" y="1090" font-family="system-ui" font-size="12" fill="#6B7280">Performance APM</text>
                        <text x="830" y="1110" font-family="system-ui" font-size="12" fill="#6B7280">User feedback</text>
                        
                        <defs>
                            <marker id="arrow" markerWidth="10" markerHeight="10" refX="5" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#6B7280" />
                            </marker>
                        </defs>
                    </svg>
                `
            }
        };
        
        let currentView = 'system';
        
        function init() {
            setupEventListeners();
            renderView(currentView);
        }
        
        function setupEventListeners() {
            document.querySelectorAll('.btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    document.querySelectorAll('.btn').forEach(b => b.classList.remove('active'));
                    e.target.classList.add('active');
                    currentView = e.target.dataset.view;
                    renderView(currentView);
                });
            });
        }
        
        function renderView(viewName) {
            const view = VIEWS[viewName];
            if (!view) return;
            
            const container = document.getElementById('diagramContainer');
            container.innerHTML = view.svg;
            
            // Update info panel
            document.getElementById('infoTitle').textContent = view.name;
            const infoContent = document.getElementById('infoContent');
            infoContent.innerHTML = `
                <p style="font-size: 0.95rem; color: var(--gray-700); margin-bottom: 1.5rem; line-height: 1.7;">
                    ${view.description}
                </p>
                
                <h4 style="font-size: 1.1rem; font-weight: 700; margin-bottom: 1rem; color: var(--gray-900);">
                    Related Patterns (${view.patterns.length})
                </h4>
                
                ${view.patterns.map(p => `
                    <div class="pattern-card">
                        <div class="pattern-id">${p}</div>
                        <div class="pattern-name">${getPatternName(p)}</div>
                        <div class="pattern-desc">${getPatternDesc(p)}</div>
                    </div>
                `).join('')}
            `;
            
            console.log(`‚úì Rendered ${view.name}`);
        }
        
        function getPatternName(id) {
            const names = {
                'C1': 'Graph Structure',
                'C2': 'Document/Artifact',
                'C3': 'Symbolic Expression',
                'P10': 'Parser/Compiler Pipeline',
                'P11': 'Validator/Checker',
                'P13': 'Indexer/Query Engine',
                'P16': 'Suggestion/Recommendation',
                'P17': 'Key-Value Store',
                'P18': 'Relational Database',
                'P19': 'Graph Database',
                'P23': 'Real-Time Sync Protocol',
                'P29': 'MVC/MVVM Architecture',
                'P30': 'Command Pattern',
                'P31': 'Observer Pattern',
                'F5': 'Collaborative Editing Flow'
            };
            return names[id] || id;
        }
        
        function getPatternDesc(id) {
            const descs = {
                'C1': 'Content as nodes and edges with relationships',
                'C2': 'Documents with versioning and metadata',
                'C3': 'Tree-structured expressions for parsing',
                'P10': '5-stage content transformation pipeline',
                'P11': 'Multi-level validation with auto-fixes',
                'P13': 'Full-text search indexing engine',
                'P16': 'AI-powered suggestions and recommendations',
                'P17': 'Redis cache for sessions and temp data',
                'P18': 'PostgreSQL for primary content storage',
                'P19': 'Neo4j for content relationships',
                'P23': 'WebSocket-based real-time synchronization',
                'P29': 'Model-View-Controller architecture',
                'P30': 'Undoable command pattern with history',
                'P31': 'Observable pattern for reactive updates',
                'F5': 'Operational Transform for collaboration'
            };
            return descs[id] || 'Pattern implementation in CMS architecture';
        }
        
        init();
    </script>
</body>
</html>

